03/20/23
Updated Scripts: train, libary, set
New Variables: TradingSell and TradingTown.  Will sell a bundle or gem pouch from your vault to learn trading experience when doing noncombat training in town.  If enabled, TradingTasks will run afterwards and top up your Trading experience before heading back.

Added combat presets for: 
P1: crocodiles, dire bears
P2: swamp trolls, piruati serpents
P3: rock trolls 1, eidolon steeds, crocodiles
Updated existing presets for: p1-origami, p1-vipers, p1-leucros

Added a throttle to berserk attempts if it fails because inner fire is low.
Lowered the timer on assessing instruments to 12 seconds from 17 seconds.
Added missing text to vault entry for when you've been kicked out for taking too long.
Barbarian forms are now stopped during travel to conserve Inner Fire.
Changed the Crossing burgle location to avoid characters with low Athletics getting stuck on the walls.



03/14/2023
Updated Scripts: train, library, set

New Variable - CollectMaterials.  Collects rare material drops from high level creatures.  Defaults to YES.
New Variable - KillBeforeMove.  Determines if the script waits for a kill before leaving combat for NonCombat training in order to get your ammo back.  Defaults to YES.
New Variable - TradingTasks.  Allows a Trader to run tasks for Trading experience during NonCombat.  Only available to Traders.  Only works in Crossing.  Defaults to NO.

Added combat presets for: 
P1: origami, cave bears, rock trolls
P2: young brocket deer, marauders, brocket deer, elder brocket deer
P3: snowbeasts, rock trolls2, gargoyles
P5: shadowflame moths

Refined how Pounce determines whether it's off cooldown.
Bugfix to warhorn use.  For some reason, DR can't handle using an adjective for blowing it, so the exhale command now explicitly uses "warhorn" instead of your WarhornItem variable.
Bugout variables have been moved to the Movement section.
Changed movement presets for Adan'f to avoid the climbing sections in Eidolon steeds.
Fixed a bug with endrus serpent presets.
Fixed incorrect burgle and perform rooms in Leth.
Fixed a bug with kick sub not working properly with dust bunnies.


03/05/2023
Updated Scripts: train, library, set

New Features
Script is now much better at detecting when you have died or disconnected, and will not just keep spitting out commands.  I'll probably do more with this later.
Added CollectBoxes and BoxStorage variables for harvesting boxes from combat.
Added Invest variable for Traders to invest Starlight Aura in their tessera to learn Trading.
Added Pounce variable for Rangers to use the new pounce maneuver for Instinct training.
New Variable: CustomMovement.  Defaults to NO.  If set to NO, the movement variables other than the presets will not show.  The intention is that I will gradually add presets for all the hunting areas as time goes by.
The prefix for all Upkeep-related movement variables has been changed to "Upkeep" to make it more clear what it does, since it's no longer the only form of movement the script uses.  UpkeepPreset variable should be set again manually.

Movement and Upkeep
Added combat presets for: 
P1: death squirrels, musk hogs, goblins, fell hogs, badgers, pothanits, giant wasps, trollkin, cougars/grendels, wood trolls, grass eels, beisswurms, copperhead vipers, endrus serpents, snowbeasts, crauyarin scuttlers, lava drakes
P3: adan'f sorcerors, adan'f blademasters
p5: ice adders, zombie stompers, zombie maulers, black apes

Fixed a bug in the timeout on the travel sub.  It should now attempt to travel again if 3 minutes have passed without the travel completing.  This should make the training script recover better if the travel script hangs.
AUMoveWhistle, AUMoveScream, and AUMoveVanish have been renamed to have the "AU" portion removed.  This fixes a bug caused by inconsistent naming.  They also will no longer trigger if there are no critters in the room.
The "score a kill before leaving a room" functionality of NonCombat training will now be considered satisfied if the room is empty of critters.
Autoupkeep can no longer be triggered while doing noncombat training or within upkeep itself in order to avoid issues.  It will go into upkeep upon returning to combat.
More changes to Fang Cove to hopefully make it recognize either Wickett, the gembuyer, or the gemsmith, or the Gor'tok clerk in the Fang Cove gem shop.
Added Mer'kresh as a valid town autodestination.  Added burgle and performing rooms.
Cleaned up room verification code and made it check way more often to make sure you're in the correct room.

Magic
AEWO and CARE removed from cyclic list.  CARE added as a valid buff.
Requirements for casting Absolution relaxed, so that it can be used in normal buff routines.
Added alert for failure to cast a Trader spell due to insufficient starlight or moonlight.
MM TKTItem object now is put directly into the container in the Storage variable, rather than stowed, in order to avoid stuffing it in weapons cases with limited capacity.
Script now can handle gracefully when you attempt to prep a spell you don't know, and will bugout if enabled.
Fixed a bug with an attempt at heroic tatttoo activation while stunned.
Added missing text to Barbarian roar sub for when your voice runs out.
Fixed a bug with how Khri Adaptation was setup.

Combat
Added missing text for melee attacks and tactics analyzing against flying creatures.
Added missing text for attempting to flee in a watery area.
Added missing text for Barbarian feleeing.
Fix for attempting to dissect an undead creature.  Script will now turn off dissect and alert you when this happens.
Fix for attempting to dual load, but See the Wind is not active.
Added Adan'f elder blademaster speech to whitelist.
Added bloodfish to list of valid skinnable critters.

Added ambergris to the list of gems to pick up.
Added missing text to musical instrument assess sub for when it tries to assess in combat.
Forage sub can now dump junk in a room when it needs to in order to forage.
Added missing text to almanac sub.
Some bugfixes to variable copying in Set.cmd.
Cleaned up some display elements in Set.cmd.
ArmorSwap variables now only show if the main variable is set to YES.  
Changed some of the default variable settings to make new characters require fewer changes to setup.


10/25/2022
Updated Scripts: train, library, set
New Features
All movement-related variables have been added to the Movement section.

Presets have been added to make it easier to select your hunting areas.  These are under the Movement section, where the valid areas are listed.  I've tried something new here where variables that are controlled by a preset will be set darker to show that you cannot change them.  Hopefully this will make it easier to navigate between hunting areas.  Some of my most frequented hunting areas have been added as a proof-of-concept, and I expect to add many more in the future.  Please let me know if you have requests.  If, for some reason, Travel and the automapper cannot navigate to some area from some town using the presets, there still exists the option to turn the presets off entirely and set everything manually.

Presets have also been added for all of the mainland towns.  They work identically to combat area presets.  P4 towns other than Ratha will be coming when I have time to test them and make certain everything is working as intended.

Added ammo purchasing both during upkeep and as needed via the AmmoBuy, AmmoBuyTown, AmmoBuyList, AmmoContainer, AmmoMin, and AUonAmmo variables.  Under the Movement section, there is a set of movement variables for ammo purchasing if you run out outside of normal upkeep, and the purchasing town can be set here for a town that is not your upkeep town, such as if you perform Upkeep in Fang Cove, but purchase ammo in the Crossing.  There are presets for this, but only certain towns are keyed this way until fully tested - currently Crossing, Shard, and Ratha.  This Auto-Upkeep behavior can be triggered with the AUonAmmo variable.  All ammo is counted using ``count <container>`` so be sure to set that properly and use the exact adjective and noun ("crossbow bolt") for a single ammo item for best results.

Added gem pouch selling with the GemSell variable.  This accounts for both non-financed (only usable by Traders) and financed shops, and if a town area has both (such as Shard) it will pick the appropriate one based on guild.  
The script will not yet travel to another town just for the purpose of gem selling - I'm aiming for that on a future version.

VaultTown variable has been added as your preferred vault town.  If you are not in the correct town, the script will ignore any vault-related activities during upkeep.  This is to faciliate using different towns than your standard upkeep town for ammo purchasing (and in the future gem pouch selling and cleric ritual supply buying).

Added ShadowlingNoun variable for altered shadowlings.


Updates and Fixes
Made room matching more exact for hunting area choosing.  Previously there was an error where being in a room that was a partial match for a room on your list (such as 188 when you wanted to be in 88) could trigger the script to have problems.
Lots of small changes refining movement between areas and in Upkeep.
Fixed speech whitelisting for adept Adan'f blood warriors.
Added missing text for Scream Defiance when you are out of mojo.
Fixed a bug that could cause a script halt if you attempted a Meraud commune on ground that was already consecrated.
Stellar Collector has been removed from the list of buff spells, as it will need its own logic.
Fixed an issue with PUTITEM sub where failing to stow some heavy loot during burgling because it's too heavy for your bag could cause the script to take too long and get you busted.
Extra checks put in place to prevent using Powershot while dual loading a bow.
Improved non-worn (or worn but removed) cambrinth handling, and fixed a bug with stowing/rewearing.
Fixed several aspects of item swapping during Performance training.
Added some missing text to dissect sub for when you attempt to dissect but nothing is dead.



08/27/2022
Updated Scripts: train, library
Swappable weapon subs should no longer break if it attempts to swap and the weapon isn't held.
ACM Doublestrike will no longer be attempted if either the main weapon or secondary weapon is a swappable weapon.  This should let everyone using swappables turn Doublestrike back on.
ACM maneuvers should no longer incorrectly report that they attempted to use the wrong weapon when in fact it just couldn't find a creature to hit.
Added missing text to sub used to move out of a combat room for when you are unable to move due to having just made an attack.
Fixed a bug with low level cambrinth using and stowing of cambrinth items.
Appraise creature sub now gracefully handles a situation where the noun it tries to appraise is also on your person (such as rats).
Appraise creature sub now gracefully handles appraising a Guardian Spirit.
Regex adjusted for summoned weapons to allow it to properly detect a "crude stone scimitar".
Fixed a bug with gem pouch obtaining in Fang Cove at night where it used the wrong noun for the NPC.
Fixed a bug with gem pouch obtaining in other cities than Fang Cove.
Fixed a bug with bundling rope obtaining in Fang Cove at night where it used the wrong noun for the NPC.
Captured additional text to make the script not lie down for too long when being healed by Quentin.
Added Cormyn's (Crossing) messaging for pawning an item with something inside of it.



03/16/2022
Updated Scripts: train, library, set
NOTE: Removing PrepTimer script from the archive, as Genie 4 now performs this function natively.
When attempting to leave combat for NonCombat training, the script will now attempt to score a kill before leaving in order to collect ammo.  Upkeep, however, still leaves immediately.
Script should be able to recover gracefully from a situation where it cannot stow an item in hand, and the fact that it cannot stow it should no longer prevent Bugout from working.
Added EmbedtheCycle as a valid buff.

Added extra STOWALL calls to Burgle and Perform to help ensure there are no excess items in hand.
Locksmith training box usage will no longer fire during Performance training if the instrument requires 2 hands.
Instrument Wipe function is now more fault tolerant if the instrument is not currently in hand.
Added functionality to cope with stowing a loaded weapon that starts in the left hand.
Added speech in Shard and from Adan'f to the alerts whitelist.
Added missing messaging for aiming failure when you've stowed your ranged weapon.
Fixed a bug that caused smite to sometimes have invalid input.
Changed some operations orders to minimize situations where Doublestrike would get interrupted by having an offhand weapon stowed before it got a chance to use it.
Fixed a bug with bar mace swapping related to it not tracking which hand the weapon was in properly.
Fixed a bug with gem pouch buying in Fang Cove at night.
Added missing text to pawning in Shard.
Added missing text for Righteous Wrath wand invoke.
Fixed some display related bugs in Set.


02/18/2022
Updated Scripts: train, library, set
General
Rewrote much of Weapon logic, which was the oldest code in the script, which should make it more reliable and easier to add new things to it.  All "alternate attacks" now run through the same process instead of plugged into whatever place worked at the time.
EvenTrain is now the only weapon selection option so that I don't have to support options that nobody uses.  In pursuit of this, the EvenTrain and MaxSwings variables have been removed.
Weapon skills, Backstab, Expertise, Tactics, and Offhand skills will now longer be used if the skill is capped.
Added some missing text for loading aimed weapons.
When stowing an item in the at-feet slot, if the stow fails because of full hands it will stow what's in your hands and then try again.
When invoking a ritual focus fails due to an occupied offhand, it will now properly stow that item and try again.

Barbarian-Related
Fixed a bug in Whirlwind that caused an endless loop.
Added RoarAnger, RoarEmbrace, RoarKuniyo, RoarScreech, RoarShriek, and RoarWail for Barbarians.  Each roar is now on its own separate 120 second timer.  If you're running a lot of them and some extra management of voice resources is needed, tell me what it needs to look like.
All meditations, forms, and berserks now run a meditate power after activation in order to sync percWindow variables.  All timers for the same have been removed in favor of manually syncing variables with no RT.
Added missing text for Berserk Tsunami.
Fixed an issue preventing Berserk Flashflood from displaying properly.
Rewrote Barbarian guild display due to some bugs.
Removed Yogi variable, as it no longer serves a function that requires tracking.
Barbarian roars, forms, berserks, and meditations should no longer attempt to fire while playing an instrument.


02/10/2022
Updated Scripts: train, library, set
New Features
Added Doublestrike ACM.  Whether or not it fires depends on having the various offhand variables properly set, so please doublecheck them.  If it cannot find an available offhand weapon it won't fire.  It decides which weapon to use by checking all of your available offhand weapons that are not capped and picking the one with the lowest mindstates.  Note that Doublestrike trains two weapons with one attack even when you're not a Barbarian.
Added Serenity meditation.
Whirlwind will now attempt to use an offhand weapon when it fires.  Uses the same logic as Doublestrike to choose a weapon.
Added shambling frostcrones to the list of undead creatures.

Updates/Fixes
Added some additional failure recovery to ACM sub.
Fixed a bug related to how dual load and powershot interact and cleaned up dual load code.
Fixed some problems with NonCombat movement to ensure that movement would only take place if it planned to actually train Performance or Burgle.
Fixed a bug with BurglePawn that could cause it to get stuck in a pawn shop.
Failure to stow burgled loot no longer turns off looting entirely - it alerts you instead.
Fixed a bug that could cause gem pouch acquisition to fail.
Gem pouches can now be acquired in Fang Cove at night.


01/30/22
Updated Scripts: train, library, set
Added ACM variables for each maneuver under the Combat section (except for Doublestrike, which needs more work).  These will process during normal training when the timer is off cooldown on appropriate weapons.  These are useable by all guilds, and seem to speed up weapons training for non-Barbarians.  Barbarians, additionally, will have Expertise combos turned off if both ACM's and Expertise are turned on.  It's one or the other, although Whirlwind is fine to mix in.
Added Su Helmas spell prep messages to the PREP function.
Rewrote GETWEAPON sub and added lots of new checks to confirm that weapon wielding is going properly.  This fixes several rare bugs that could happen.
Improved STOW function operation and tightened up several checks.
Added missing text for Berserk Landslide.


1/13/22
Updated Scripts: train, library, set, preptimer, p

New Features
Significant changes to Movement, Alerts, and NonCombat variables in this update.  I highly recommend you check all of these variables before running the script again.
Solved some issues with Alerts by making all alerts under the General heading global variables.  Previously these were unique to the variable mode you were in.
Added a new variable, PVPAlerts, which is set to YES by default.  This exposes a set of alerts to be changed that formerly could not be turned off.
Movement logic has all been updated, and all movement between rooms now runs through the same code.  In addition, all sets of movement variables now inclide a Zone variable, to specify which numeric zone it expects to be.  If this is set to 0, or if it matches your current zone, Travel and Move functions will not run.  In addition, there is now a TargetRoom option for all movement variables.  This allows you to set a desired landing room separate from the MoveList variable.  If set to 0, it will not be used.

NonCombat Related
MoveTrain variable has been renamed to NonCombat to better reflect its current role.
MoveBurgle and MovePerform variables have been renamed to just Burgle and Perform, respectively.
Burgle, BurglePawn, and Perform now all have their own movement variables to allow for different rooms for each.
BurglePawn has been significantly improved, with several bugfixes and additions to smooth out the logic.
Extra checks added to ensure that invisibility would not interfere with playing an instrument and invisibility removal subs combined and cleaned up.

Updates and Fixes
Item handling logic is now better at dealing with a gem it tries to stow but cannot, due to a full pouch.
Gem handling will now attempt to find an empty pouch, wear it, and set it to default gem storage if it notices that gems are getting stored in something other than a gem pouch.
Combat variable has been renamed as Weapons to more clearly reflect what it does.
Fixed a bug with Berserk Drought that caused it to throw up errors.
Fixed a bug with the Taisidon baldric having missing text for stowing an item.
AugmentTrain and WardingTrain, and associated code have been removed due to needing updates because of changes and no longer appearing to be necessary.
Added missing messaging and SpeechAlerts whitelist for Oath of the Firstborn.
Added missing messaging for Whole Displacement cast to prevent a script halt.
Added missing messaging for needing to purchase a vault during upkeep to prevent a script halt.

Fixed a bug with PrepTimer and AP spells.
Added Oath of the Firstborn to PrepTimer.

P script will now properly stow or store your ritual focus based on the variables set.


12/03/2021
Updated Scripts: train, library
Several bugfixes to gem pouch vaulting logic and associated regex.  Should be working fine now.

12/02/2021
Updated Scripts: train, library
Khri activation rewritten to resolve some issues with improper splitting.
Gem pouch identification, both full and empty, has been rewritten to be much more accurate.  It should no longer make mistakes based on item ordering, as it re-searches every item when an item is added or subtracted from the bag, and it also now correctly identifies gem pouches containing less than 500 gems as "empty" and needing more filling.  This should ensure that the correct number of pouches are acquired during upkeep, that non-full pouches will not be vaulted, and ensure an empty pouch is grabbed when the existing pouch is full.
Moon Mage power perc has been modified to no longer occasionally do a regular perc, as spell durations can now be checked with no RT.
Removed some on-screen comments that were no longer needed.


11/21/21
Updated Scripts: train, library, corn
Added Enrichment as a valid buff spell.
Several small bugfixes to cornmaze script, including adding a new loot list.  If you want to keep everything, comment this line out and use the old one that reads "var keeplist .*"


11/18/2021
Updated Scripts: corn
Updated movement subs for greater stability.
Forced script to wait for full room description before processing room data on a move.
Fixed a bug that could cause it not to be able to find a halfling if it had previously located it but it moved too far away.

11/18/2021
Updated Scripts: train, library, set, p, hesmash, helibrary
Fixed a bug with casting the new COL.
Fixed a bug preventing Berserk Drought from properly firing.
There are now 4 possible variable sets instead of 2.  Only the first two will work with MultiTrain at the moment.
Under the OTHER heading in SET, P, the standalone casting script, now has a variable called PScriptMode instead of all of the other variables that used to be there.  This determines which script mode it loads variables from.  Default is 1.
HESmash now allows Empaths to self-heal.  This uses the same variables as the P script, as well as the mana variables for Heal under the guild section in the same script mode as the P script is set to.
HE scripts now can figure out how to get to Andreshlew if you begin them in the Crossing.

11/12/2021
Updated Scripts: train, library, set, hecna

Training:
Added KhriAvoidance variable and code.
Added BerserkDrought variable and code.
Bloodthorns, ELI, FOTF, GF, GI, NON, PHK, RITS, STC, TK, TKSH added as valid buffs.
Bloodthorns, FOTF, Ghoulflesh, GI, RITS, TK, TKSH added to PrepTimer.
Added RITSType variable for Rangers.
Removed moon requirement code for COL.
Removed legacy GF code.
Ghoulflesh is added as a valid buff, but the script does not handle having a zombie out, so that's something you'll need to take care of yourself if you want the script to cast it.

Hollow Eve:
Crown and Anchor now will go for more money if it runs out.

11/12/2021
Updated Scripts: hecna, hesmash, train
Smash now moves out of the otter room to deal with lodged fragments before going to get healed.
Crown and Anchor now bets 5001, and the lightning suit has been removed.
Added a bunch of STT and CNA speech to the whitelist, for those who want to run .train alerts while running the games.

11/11/2021
Updated Scripts: hestt, hesmash, helibrary
STT has had the change to joinging the list reverted, because the list is still broken and drops people.
Smash now checks to see if healing is needed before grabbing a new shell in order to cut down on excess stored shells, and will also now tend out any lodged shell fragments when getting healed.


11/10/21
Updated Scripts: hestt
Pause between runs has been raised to 30 seconds instead of 20 seconds to work around a bug in how the game functions.
Script no longer attempts to join the list multiple times, since it looks like they may have fixed the bug with it dropping people.

11/10/21
Updated Scripts: hestt, helibrary
HESTT has been made a lot more careful about stowing anything that might be in your hand before you get awarded your prize, in order to prevent accidentally dumping something else in the bucket.  HESmash has not received this same treatment yet, so be careful not to have anything else in your hands at any point in running the script.
HESTT now uses the bucket that's in the STT area instead of the one farther away.
Fixed a bug in the GOROOM sub in helibrary that would case it to output bad data if it had to wait for roundtime.

11/07/21
Updated Scripts: hestt, hesmash, helibrary, corn, train
Some minor changes for greater fault tolerance.
STT and Smash will now both automatically go to the teller for more money when you run out.
Moving between rooms not on the automapper should be much more fault tolerant.
Corn maze script now should keep all incidentals in order to facilitate trading them in later.
Yrisa and various Merelew speech has been added to the speech whitelist so that .train alerts can be run during tasks.


11/05/21
Updated Scripts: helibrary
Combined all icon items into a single entry in the loot list.
Added the correct spelling of the "dark green sack made of desiccated kelp" to the lootlist in case they fix it.
Added the following items to the loot list: .* sanowret crystal|diaphanous silk dance veil adorned with .* blossoms|intricately ruched garter of .*|.* velvet toy sword with a .* grip|competition miniature coral Andreshlew studded with tiny .* tents|miniature polar bear with round .* eyes|toy clockwork .* dirigible.


11/05/21
Updated Scripts: hestt, hecna, hesmash, helibrary
Updated CNA to use a bet amount of 5334 kronars.
Updated room numbers for STT and SMASH.
Increased pause between games for STT.
Some structural updates.

11/04/2021
Updated Scripts: hestt, hecna
Updated Crown and Anchor to use a bet amount of 10000 kronars.
Stupid Terrestrian Tricks is now able to handle not being whispered to, and should deal better with multiple people running it at a time.


10/02/2021
Updated Scripts: train, library, set, preptimer

New Features
Added Khri Insight, Flight, Shadowstep, and Evanescence to be used as buffs.
Added Claws of the Cougar, Earth Meld, Hands of Lirisa, Essence of Yew, Instinct, Memory of Nature, Oath of the Firstborn, See the Wind, Senses of the Tiger, Syamelyo Kuniyo, Skein of Shadows, Wisdom of the Pack, and Wolf Scent to be used as buffs.
Rewrote Spell and Buff display in Set.cmd to be more attractive, concise and to no longer hide unused variables.
PrepWait variables to allow you to choose how long the script will wait before casting the spell are now live with all spells under the Spell and Buff headings.
Shard gate sentinal messaging should no longer trigger speech alerts or name mentions for citizens.

Additions and Fixes
Bugfixes to wand storage.
Numerous fixes to Heroic Tattoos to make them better at staying up.
Improvements to Runic Tattoo timing.
PrepTimer script spell matching made more exact in order to prevent mismatches.
Fixed an issue with tap shortening.
Fixed an issue with nested item handling subs causing a variable mixup.  Example: getting an item, but can't because the hands are full, so stow the hands, but then can't because the item needs to be removed.
Cleaned up regex in the SpeechAlert whitelist.


10/02/2021
Updated Scripts: train, library, set
Added Air Bubble, Soul Ablaze and Anti-Stun as buffs.
New variables: WandXPrepWait.  This sets the number of seconds to wait before casting the buff.  Setting this to 0 (the default) has it wait for full prep.  This allows for faster buffing for more experienced casters.
New variables: SymbiosisBuff, SymbiosisSpell, SymbiosisPrepMana, and SymbiosisAddMana.  These allow setting a spell in buff settings to carry a symbiosis for buffing purposes.
New feature: .train buff <minutes> will now recast any buffs with durations below <minutes>.  This is effectively setting the BuffBuffer variable in the command line.
New feature: Heroic Tattoos are in!  New variable is TattooType.  This allows you to set a runic (default) or heroic tattoo.  This code is new, and I'm still refining how it reapplies the tattoo, but it should be basically working.  
Made fixes to STOW functions in order to make the WandStorage variable behave better and hopefully not put wands in the wrong container.


09/18/2021
Updated Scripts: train, library, set, p
Initial perc now uses the 0 RT PERC SELF, and PostBuffPerc variable has been removed.  This functionality is now automatic.
Added treehopper toad and suw bizar to list of skinnable creatures.
Sanowret Crystals, Expertise, Bardic Lore, Theurgy, Empathy (both IZ and Maniuplate), Astrology, Conviction, Backstab, Summoning, Stealth, Tactics, Outdoorsmanship, Perception (hunting), Performance, Scholarship, First Aid, Athletics (on windboards), and Locksmithing (on trainer boxes) will no longer fire if the skill is capped.  Burgling will not choose tools that are capped unless both are, and burgling will no longer fire if Athetics, Locksmithing, Thievery, and Stealth are all capped, but will still fire if any are trainable.

Whitelisted speech alert text in a couple of rooms in P5.
Fixed a bug with pilgrim's badges where the script could fail to recognize you had successfully gotten it out if it was in your left hand.
Altered logic with pilgrim's badges so that the timer would not be reset and reporting would not occur on a failed attempt to use it.
Cleaned up Stealth and Tacitcs logic.
Fixed a bug with upkeep that could cause it to fail to go to the teller properly.
MoveTrain will now not trigger if Performance is higher than 20 mindstates in order to avoid immediately starting performance every time the script is restarted.
Fixed several bugs with the variable copy in Set.

Fixed a bug with Moongate on P script.


08/20/2021
Updated Scripts: train, library, set

Added Tithe variable for Paladins.  Setting this to YES will cause Paladins to tithe when they run upkeep in an appropriate town.  Currently active in Crossing, Riverhaven, and Therenborough.  Shard is more complicated, and will have to wait, Aesry and Ratha I'll get when I make it out there.
Fixed a bug in the new variable system that caused Paladin anloral pins and pilgrim's badges not to fire properly.
Fixed a bug that caused Osrel Meraud to potentially be cast even when in Alerts mode.
Fixed a bug with wand spell variables not being properly set.
Fixed a bug with wand activation that could cause the script to stow one of the wands before using it if the game moved too quickly.
Fixed a bug with Quentin in Shard that could cause Upkeep to get stuck.


08/15/2021
Updated Scripts: train, library, set, preptimer, astral, p

New features
Added proper support for TKTItem variable to TKT spell as well as TKS.
Copy function now can either copy "all" variables or by variable heading (general, upkeep, etc) in order to make it easier to duplicate things like buff setups between script modes.
Updated upkeep functions to use single repair shops in all locations, since they can now repair all items.  Updated text for new repair mechanics.  Tested extensively in Crossing and Fang Cove - let me know if any errors pop up in other locations.
Updated repair shop and furrier in Boar Clan upkeep.
Stealth will now automatically train non-violently for Paladins if set to YES, in addition to Empaths.
Updates to P script to make it work properly with the new variable setup.  P now has many of its own variables independent of main script that will need to be set.

Bugfixes and updates
Fixed a bug with the KillAfterLock variable which could cause it to never pick up normal weapon operation after engaging.
Fixed a bug with wand usage that could cause them to potentially fire more often than they should.
Adjusted Thief variable loading to make ".train buff" not attempt to reapply khri that were already active.
Added some missing text to the Collect sub.
Added some missing text to the Flee sub.
Fixed a bug with half-handled ristes that could cause a script halt.
Completed code review of magic, treasure, upkeep, Bard, Necro, WM, and MM subs.  They are now much more fault tolerant.
Gem pouch swapping now attempts to set the default storage location for gems to the new gem pouch.
Fixed a bug in the logic using the zone variable that could prevent it from properly recognizing a zone with a letter in it.
Fixed a bug with storage variable that could cause it not to properly count gem pouches and bundling ropes.
Fixed a bug with movement mechanics that would prevent using the MoveList to return to combat if you were in another zone in a room number that matched the FindRoomList.
Fixed a bug in Assess regex which would cause the script to not properly identify creatures at melee with you that lacked an adjective (such as "a snowbeast").

Mode switching now recognizes when you're trying to change to a mode you're already in and echoes appropriately.
Fixed a bug with first time variable initialization and the decision on whether to import from old variables.
Fixed a bug with Mind Shout variable correction.
Fixed several bugs related to variable display and mode switching.
Fixed a bug that could prevent proper setting of some variables that contain a combination of letters and numbers.
Rework of how variable checking is run to prevent duplication of code (and the errors it causes) when running checks on both modes.
Reorganized Combat2 display.

Fixed several bugs on exact spell timing in PrepTimer.
Bugfix to Astral script to prevent a script halt.


07/19/2021
Updated Scripts: train, library, set
Room leaving functions have further safeguards to prevent Rite of Grace being removed from a Necromancer with NecroSafety on.
Fixed a bug in data validation that could allow spells the script was not setup for to be set as a buff.
Added Clarity spell to the script.
Changed Osrel Meraud recast point to 20%.
Fixed several bugs in Set related to display of variables.


07/11/2021
Updated Scripts: train, library, set
Reordered pre-run operations on script to solve a problem that prevented Rite of Grace from being detected properly on script start.
Bugfixes to Necromancer ritual target choosing.
Still more bugfixes to SpeechAlerts that should now make it properly show you who was speaking.
Fixed a bug with variable conversion from old versions of the script related to Burgle.


07/09/2021
Updated Scripts: train, library, set
Removed special Thief mechanics for wand use, since Thieves can now see magic properly in the spell window.
Removed Crossing driver at the gate and Shard gate guards from speechalerts.
Spellcasting will no longer attempt to cast spells if skills are capped, with the exception of noncombat cyclics, which will leave the first cyclic going if all available cyclic skills are capped.
Fixed a bug in MOVEANYROOM pause function.
Further improvements to pre and post title pruning regex.
Dragon Priest zealot speech put on the whitelist.
Bugfixes in Set to display for Buffs and Osrel Meraud buffs.
Bugfixes to variable validation for TacticsWeapons, CastingThrottle, and TeachTargets.
NonComSanowret and Research variables moved to NonCombat section in Set in preparation for a larger revamp of noncombat training.
Fault tolerance for disconnections/hiccups completed in Thief and Barbarian subs, and started in magic subs.
Fixed an issue with robed Dragon priests that prevented them from being properly recognized by the script - their capitalization is, for some reason, different than other Dragon Priests.


06/08/2021
Updated Scripts: train, library
Bugfixes to pathway usage.
Cleaned up code for elemental weapon usage.
Added webbed messaging to pre and post-title scrubbing function.


NOTE: This version of the script has some changes that will require reading the notes and possibly checking with me if you have any questions.  There's a lot more to go here, and I'm almost looking at a 2.0 version of the script with what I'm working on, but putting out too many changes at one time tends to be too disruptive to people.  So I tried to balance it with this big update.  Also, putting too much distance between my codebase and what people are using makes it hard to bugfix minor things.

06/07/2021
Updated Scripts: train, library, set, custom, preptimer

Major Changes
Set.cmd has been heavily revamped, and several new functions have been added.  You can view the syntax by typing .set.  It is recommended that you look closely at the GENERAL and MOVEMENT sections.  There are some big changes.  NONCOMBAT has been renamed to COMBAT2, and MOVETRAIN has been renamed to combat to better reflect the roles of the headings.  More changes are to come here soon, with spearate noncombat variables for actions that can be done both in and out of combat.

There are now two variable sets built into the script.  Your prior variables will have been automatically ported into what is labeled as Mode 1.  Set.cmd views only one mode's worth of variables at a time.  The current mode will be shown at the top of each variable heading, and the mode chan be changed with .set mode <1 or 2>.  One mode's full variable set can be copied to the other mode using .set copy <source> <destination>.  When starting .Train, it will use the variables of the current mode in Set, OR you can type, .train <script mode> <1 or 2> to select the mode when the script starts.  This is to facilitate MultiTrain functionality.

New function - .train multi.  This option is used to run multiple variable sets for Train in order to hunt in multiple areas, and will check the specified list of skills to decide which one to train first.  The logic is that, when looking for a skill to train, it figures out the one with the lowest mindstate on each list, and then chooses the one that's lowest.  It will then raise the skills on the list by a number of mindstates equal to the step variables and look for another to train.  The variables for this are under the GENERAL heading.  When MultiTrain chooses a mode, EVERY VARIABLE is reloaded from the new mode, which means every last thing about how your character operates can be different in the new mode. For example, Saragos trains as normally in void moths in Mode 1, but then when he switches to mode 2 he moves to zombie headsplitters, uses an entirely different set of weapons, takes no other actions except weapons, and casts no spells except maintaining his buffs.  He also swaps AEG for MOF in his buffs.  This is to facilitate moving the lower weapons as fast as possible.  It is critially important to make sure that variables under the MOVEMENT heading are properly set to use MultiTrain.  Please let me know if you run into any difficulties setting this up, and I'll help you with it.  I've tested everything thoroughly with my characters here over the past couple of months, but that doesn't mean I'm perfect, so let me know if anything doesn't seem to be working right.

MOVEMENT heading:  All movement back to your hunting ground has been unified.  At script start, as well as whe returning to a hunting area for some other purpose, the script will look at the Zone variable and travel if it doesn't match, and then do the Move section if you're not in the proper hunting area.  FindRoom functionality will then run.  This means combat training can be started from anywhere.  If you don't desire this behavior at script start, set Zone to 0, and FindRoom to NO.  In addition, movement logic has been unified, and "go <portal> is now a valid entry for movelist.  This allows navigation through areas that the automapper can't properly handle. 

New variable: TacticsWeapons.  A list of weapons that tactics will be used on.  Includes all weapons by default.
New Variables for WM's: ChargeAfterLock, CALSpell, CALPrepMana, CALAddMana.  If enabled, this gives you the option to have a spell repeatedly cast even after your magic skills are locked in order to build Elemental Charge.
New Variable: BarMaceITem.  This will allow proper setting and swapping of a bar mace.

Preptimer has been heavily revised and tested, with spell prep times updated and new spells added.


Small Changes and Bugfixes
Script will now perform a full cyclic release at script start if NecroSafety is on, so long as Rite of Grace is not detected.
Rewrote and organized script setup and variable loading functions.  Script should start more quickly.
Fixed a bug where Aegis of Granite would prevent proper matching of a whitelisted ally.
Massive improvements to functions to process player pre and post-strings in order to properly match whitelisted allies for all instances where lists of players are used.
Fixed a bug where wand 2 would attempt to be used even if it wasn't set.
Changed how wand variables are displayed.
Improved default variable setting / error checking for wand variables.
Power perc will no longer fire after the first time if Attunement is capped.
Fixed a bug that was causing speech alerts not to echo properly to the log window.
Added some missing messaging if you try to repair something that can't be repaired in Fang Cove.
Added missing text to TEND function.
When there's no creature facing you, the assess function will now attempt to face the next creature, even if it's facing someone else.
Put in a fix for analyze to use FACE NEXT under some circumstances.
Running out of gem pouches and bundling ropes will now run Bugout if it's enabled.
Some improvements to item handling for item repair during upkeep.
Gem pouch checking now uses "my" for the container to ensure it's not looking at items in your vault.
Squelched black marble gargoyle death speech from SpeechAlerts.
All weapon swapping functions now have the new messaging added.



04/05/21
Updated Scripts: train, library
Epistemic Journal tracking variables are now persistent between script sessions to avoid time wastage at script start.
Fixed a bug that caused AutoUpkeep not to properly message when running upkeep due to burden (though it was still doing it).
More small changes in mana arranging functions as I work towards properly accounting for all of the permutations of harnessing/cambrinth variables being on or off and capped skills.
Fixed a bug with Locksmith training boxes.
Added a function to check for ammo that landed at-feet if it detects your ammo falling to the ground or landing nearby.


03/31/21
Updated Scripts: train, library, set
New FindRoom functions under General.  This is a big one.  By having it able to pick a room, I'm a big step closer to training in multiple areas.  Try it out on a map and watch it pick a room.  For now, it shows its logic in the Main window for debugging purposes if someone spots it doing something strange.  I will say, though, that I've heavily tested this portion of the script.
FindRoom - Decides if the script will accept the room you start the script in to hunt, or if it will search for one in the range of rooms you've provided.  It WILL first check the room you're in, which allows you to attempt to choose the room, so long as it doesn't fill up.
FindRoomList - The list of rooms the script will check to see to find a hunting area.
FindRoomZone -  The zone those rooms are in.  If you start the script in the proper zone, but not in the listed room, it will move to the proper room.  For example, I'm now moving between two hunting areas on the same map.  I just .train combat and it takes me to the appropriate rooms and picks one.
FRWhitelist - List of people that are friends to hunt with.
FRBlackList - List of people that you don't want to hunt with.
FRPreferGroup - Whether you prefer to hunt with a whitelisted friend over an empty room.
Decision-making flow:  First, it checks if your current room is acceptable.  Then it runs through all of the rooms.  If it finds an immediately acceptable room (empty, or has a whitelisted friend, depending on the FRPreferGroupvariable), it will stop and hunt there immediately.  If not, it makes a second choice (the next best of empty/whitelisted friends).  If it still doesn't find one, it looks for a room that has someone in it that's not on your blacklist.  If by some miracle every room on your list has blacklisted people on it, the script will decide to YOLO and pick one, rather than stop hunting.

Changed NecroSafety and Teaching subs over to a more reliable method of determining if there are any players in a room, and cleaned up buff logic for NecroSafety.
Assessing will no longer occur during script modes other than combat.
Throttled dead monster checking functions to avoid wasted time of attempting to skin/search something that you've already searched and re-assessing combat, which could occur with certain configurations (AoE TM, LootAllDead).  Once skinning/looting happens, it won't attempt it again for 3 seconds.
Fixed a typo in Set that prevented loot variables from being able to be displayed.
ExpLogging and SpellTracking variables have been removed.  Those functions need a rework to be considered worthwhile.
ARRANGEMANA sub is now called earlier to avoid some strange interactions and fix a bug where when both cambrinth and harnessing were turned off, the addmana would just be dropped.


03/22/21
Updated Scripts: train, library
Changed where CUSTOMSETS sub is called to prevent an issue where guild-based variables don't respond properly to custom settings.
Attempted to fix a bug caused by the new facing code where if it wants to do brawling, but has a weapon-based tactics analyze going it would get stuck.  Script now attempts to face next in this case to reset the analyze.


03/20/21
Updated Scripts: train
Fixed a bug with SummonWeaponTimer.


03/20/21
Updated Scripts: train, library, set
New variable - CastingThrottle.  This is the number of seconds spellcasting is forced to wait after a cast before checking variables or attempting to cast again.  Default is 1.
New variable - SkinAfterLock.  Defaults to YES.  If set to NO, you will not skin creatures after you lock skinning.

Fixed a bug (hopefully) with cyclics that was causing TM and Debil spells to be recast, even when they didn't need to be.
Added quartz, marble, onyx gargoyles to construct and skinnable construct lists.
Summoned weapon logic will now detect the kind of weapon summoned, and if one was summoned, so that it knows what to break.
Appraising creatures now uses the 'quick' modifier.
Script should now attempt to retreat before performing Meraud commune or creating a Domain.
Fixed bugs with SkinFaTrainerTimer, WindboardTimer, and LocksmithBoxTimer variables preventing them from working properly.



03/18/21
Updated Scripts: train, library
The script will now attempt to keep facing the first creature that's facing you, and will assess to make this happen.  I've been testing this with my characters and it seems to be working fine, but let me know if any weirdness results from this.  Empaths using AvoidShock for engagement are currently unchanged, though I will probably incorporate elements of this into their logic.
Added arthelun cabalist corpse messaging.
NVTactics variable has been removed.  The same function happens if AvoidShock is turned on, you're training tactics, and facing a shock critter.


03/16/21
Updated Scripts: train, library, set
RESEARCH option has been added to main training script.  If used alone, it will research using your research variables, which are under the Spell section.  If used with a modifier, it will specifically do that kind of research.  This is new, and I'm still testing it.  Added all symbioses, even the stat/skill boosting ones.
Moved Performance and Burgle-related variables under the MoveTrain heading.
New variables - BastardSwordItem, HolyIconItem, RisteItem, and HHRisteItem.  These variables govern swappable weapons.  They must be set to the exact same text as the weapon name.  So if I am using SBWeapon = "half-handled riste", then HHRisteItem must also equal "half-handled riste", or it will not properly swap.  Ristes should always be two words in order to prevent accidental matching between half-handled and regular ristes.  Tested with my half-handled riste and things were working fine.  Let me know if anything is acting strange.
Added Grounding Field under the Guild section for WM's.  Tested, should be working fine.
Movement-related, Barbarian, Thief subs have been properly retrofitted for the new timeout feature for subs, which makes the script much more robust.  Magic subs are next.

If you are hidden when it's time to leave a burgle, it will now unhide before moving for greater efficiency.
Added Glythtide's Gift text to CAST sub.
If you set both Cambrinth and Harnessing to NO, then you will now prep at full value the combined total of the PrepMana and AddMana for spells instead of just not using that mana.
The StraightCast function now understands capped ranks.  If both Arcana and Attunement are capped, then it will understand to just prep at the full value.
Added some missing messaging for Ratha repair shops.
Fixed a bug with Mantle of Flame not being cast.
Fixed a bug with a variable not being properly loaded for Berserk Tsunami.
Added Arthelun Cabalist and Red Bristled Gremlin speech to whitelist for SpeechAlerts.
Added "that is setting" to list of text strings to trim from monster post-strings for parsing purposes.



03/14/21
Updated Scripts: train
Fixed a bug I introduced last night for upkeep for non-premium characters.


03/13/21
Updated Scripts: train, library, set
Added some missing text for epistemic journals if you have exactly 1 hour left.
Fixed another bug with TeachingSkill that would prevent you from properly setting it with skills that are two words long.
More fixes to Lakyan ticket giving to prevent tickets from not being converted back into weapons under some circumstances where you have mixed Lakyan and repairman tickets.
Fixed a bug with setting the HYHCast variable properly to the new options.
Added some additional missing text to bastard sword swapping function.


03/11/21
Updated Scripts: train, library, set
Locksmithing boxes, Skinning and FA trainers, and Windboards now have timer variables associated with them: LocksmithBoxTimer, SkinFATrainerTimer, and WindboardTimer.
TM, Debilitation, and regular spellcasting for experience will no longer be used if you are capped in the skill.  This is the beginning of a long process of making the script account for capped skills without you having to turn them off manually.  Cyclics are currently unaffected.
Added Mantle of Flame to the buffs list.  The cast function will now release Mantle of Flame before casting if you are casting Aegis of Granite, and vice versa.

Added some missing text for appraising a monster when nothing is in the room.
Added some missing text for selling an item that's not empty in Ratha.
Fixed several bugs related to riste use and swapping.
Fixed the allowable list of teachable skills in combat in Set.  It will no longer allow you to set data in that variable that will make things break.
Fixed some old validation code that could prevent setting WandBuff variable properly.



03/09/21
Updated Scripts: train, library, set
If the game is still connected but a sub times out 10 or more timess, then the script will put the character to sleep and bugout if bugout is enabled.
Running out of aimed weapon ammo will now message the alertwindow, and will put the character to sleep and bugout the character if bugout is enabled.
Work has begun to add an auto-reconnect function, but I've got more underyling work on the functions in Library.cmd to do before that will work.

Whirlwind will no longer be attempted when you're brawling.
Fixed an issue with TM and debil spells where if the skill was set to sorcery they still wouldn't be used if debil or TM had been locked.
Lengthened wait time for sorting bundles when swapping them over to make sure lag doesn't cause it to fail.
PUTITEM sub now will attempt just a STOW if there's no room in the container it wants to put something into.
Modified timeout function to be a little less obnoxious.
Fixed a bug that could cause the thrown weapon sub not to properly stow an accidentally full opposite hand if lob was used.
Added "that is caught in a cage of swirling darkness" to text to trim from a critter poststring when processing it.
HYHCast variable can now be set to "male offense" and "male defense" in addition to "coz" or "male".  Added into to Set.cmd to show what variables are possible.


03/03/21
Updated Scripts: train, library, set
New Features:
Added one-handed Whirlwind functionality.  Please test and report back, as I had to code this blind, not having a barbarian capable of it.  When enabled, whirlwind will replace normal melee weapon attacks if the script would otherwise not be using stealth, tactics, or expertise.

Updates:
Fixed a typo that prevented from SHW from working.
Necromancer Harvest and Dissect rituals choose to either ritual or skin based on whether Thanatology or Skinning has the lowest mindstate if the creature it's working on is skinnable.  Dissect will now explicitly take priority over harvest if both are selected.  I plan to do something a little more complicated here later to allow it to harvest up to the amount of material you want to store, then switch away.
Added "that is lying down" and "that is webbed" messaging to function that scrubs posttext from critter names to avoid some issues with not properly identifying the monster noun.
Fixed several upkeep issues on Ratha.
Text that matches for the need to pause (for roundtime, stuns, etc) has been standardized and is now tied to a variable rather that replicated in all the subs.
Added text for the whirlwind special attack in dolomars to the wait string.
Added text for calm messaging to the wait string.
Focus invoke function can now handle a situation where it gets called, but you don't have both hands free.


03/02/21
Updated Scripts: train, library
Added Braun's Conjecture to possible buffs, and Shadow Web to cyclic debil.


03/02/21
Updated Scripts: train, library
Refined ammo collecting logic.  It should no longer fail to collect when using Custom.cmd variables, and should no longer try to collect arrows when there is something "narrow" in the room.
STOWITEM function can now gracefully handle a situation where it confuses the item in your hand for an item on the ground, which it cannot stow because your hands are full.
Added some missing text to PUTITEM function for a failure due to the item being too long.
Added missing text for STOW attempts that fail because the gem was looted by someone else.
Added some missing messaging for Lakyan's apprentice.
Adjusted ticket redemption functions for fang cove to prevent instances where you would not properly redeem your tickets for items under the case that you had your item taken by Lakyan, but were not able to redeem it until the after the changeover to the repairman happened.
Further countermeasures added to help the script navigate between the Lakyan and repairman changeover.
Added missing text for repair all on the repairman when nothing needs repairs.
Fixed a bug when checking gem pouches to see if they're full or not when deciding to store them in the vault.
When selling burgled items that cannot be sold because they have other items in them (such as the boxes with keys), the script is able to gracefully dispose of the item.
Added proper messaging for Tranquility to the CAST function to prevent a script halt.


02/19/21
Updated Scripts: train, library, set
Major Updates and New Features
More reworking and review of library functions for increased stability.  Item handling and combat functions are now complete.  This accounts for approximately 50% of the library, but includes the most commonly used functions outside of magic.  Script should be much better at recovering from internet hangs or temporary discos.  The plan is to ultimately give the script the option to auto-reconnect to the game, but more architecture work has to be done still.  Kill script will need to be modified to work correctly, so I'm removing it from the repo for the time being.
Added variables for multiple wands for buffing.  WandBuffNum decides how many wands you can use, current maximum of 2.  Everything else follows the existing format.  Currently valid wand buff spells are hes, mef, rage, rw, sw, will.
New variables: BurglePickWorn.  This determines whether or not your lockpick is worn on a lockpick ring.  BurglePickItem determines what your lockpick item is.
Rewrote Fang Cove item repair to only use Lakyan, and to be able to function day or night.

Bugfixes and Minor Updates
Added Celestial Compact prep messaging.
Anloral pin code can now perform the Eluned commune if you're out of holy water, and bless your water if you have no holy water.
Anloral pin functions now specify your water container specicifically to avoid taking water from another location.
Tweaks to burgle function to prevent it from thinking it's in the wrong room if the fooststeps message comes just an instant before the new room description.
Fixed error text in STOW function.
STOW function now can handle all types of rope if it needs to be coiled, not just heavy ropes.
Added Malk'smo constable to the list of guards to avoid for burgling.
Burgle functions are now much better at recognizing when you've been arrested and properly pleading, whether you get caught entering, leaving, or inside.
Burgle functions are now more careful about making sure you successfully put an item in your bag before putting the item on the list of things stolen.
Burgle functions now automatically trims excess words from the middle of the short to avoid issues with the parser.
Fixed a regex bug that was causing burgle fines not to be displayed properly in the log window.
Fixed a bug that was causing MoveTrain to mistakenly deep sleep when training performing after burgling.
Added Dragon Priest purifier speech to whitelist.
Added immobilization to all pause checks in the script, in addition to webbed, type-ahead, stunned, etc.
Added the "that is trying to remain hidden" string to monster list parsing.
Added missing text to repair function for when you don't have enough money.
Fixed a bug in appraising creatures that could cause a script lock.


10/24/20
Updated Scripts: train, library, set
Added KhriFlight, KhriFright, KhriSensing and KhriSight variables.  These may be used during normal training, but I mostly added them in order to have the khris properly removed during when training when they'rem not needed, as well as to allow them to be used via .train buff or a custom variation of it.
Added SkinFATrainer and SkinFATrainerItem variables to support the skinning/first aid training items.  These work identically to the locksmith trainers.  They're used until the relevant skills are locked, and then they're given a rest until one of them falls below 20 mindstates, continuing on until there are no uses left on the item.
Minor stability work on combat subs in Library.cmd.


09/09/20
Updated Scripts: library
Bugfix to WandBuff and WandSpell variable error checking.

09/08/20
Updated Scripts: train, library, set
New Features
Added the new questions to GM Alerts section.  They will now show up in your AlertWindow.
WandBuff and the associated WandSpell variable had to be changed to deal with some bugs relating to double-activation and wasting of time.  It now works with specific spells - mef, will, hes, and rw.  If anyone has a wand device that invokes a different spell, let me know and give me the casting message.  Set.cmd has been appropriately updated to only allow valid inputs.  For Thieves and Barbarians, MEF is the only one that currently works, due to it being hard to track perfectly.

Combat Updates
Added immobilization messaging to standard "wait" function to prevent script halts.
Added missing text to FIRE sub to prevent a script halt.
Improvements to balance detecting regex.
Low balance move (jab/feint) will now pre-empt low fatigue move if both are present.
High powered attack for blunt weapons has changed from chop to bash.
High powered attacks (chop, lunge) will now require that stamina is > 90 to perform them.  High powered attacks also now only fire on "incredibly" balanced rather than that and "adeptly" balanced.
Fixed an issue where the script could sometimes fail to skin a kill if the killing blow happened with extremely low balance.

Other Updates
Added missing text for Tamsine commune.
Fixed a bug with Tamsine commune usage that would cause it to run too often to gain experience from it.
Added a longer pause to info gathering portion of WandBuff logic to prevent accidental misfires.
Fixed a bug with WANDINVOKE sub that could cause the second device to be mistakenly activated.
Added missing messaging to dirt stacker upkeep.
Refinements to upkeep for Fang Cove repairer.  Will no longer attempt to repair at the "dawn" time.
Upkeep now tops up money to the MinMoney value immediately after selling any bundles in order to prevent issues of running out of money.
Added a workaround to map issues with Fang Cove when leaving the Carousel.
Fixed a bug with NecroSafety that can cause buffs not to be renewed when MoveTrain is enabled due to the script thinking it's hunting in a justice area.
Adjusted DROP sub to handle a situation where if you were dropping a kaleidoscope from the shoplifting system and were invisible but not hidden, the script would fail to drop and you would get caught.


08/04/20
Updated Scripts: train, library
Fixed an issue with dumping items that was causing sacks from repairing not to be properly disposed of.
Dual loading now attempts to load directly from your quiver, instead of getting your ammo out for the shorter load time.


08/03/20
Updated Scripts: train, library, set
New variable: KhriMax.  This is the maximum number of khri you are able to start with one command.  During buffing functions the script will now gather all of the khri that you want to start and will attempt to start as many of them as it can at one time.
New Variable: TsunamiBackup.  Berserk Tsunami will now attempt to get this weapon out before it activates Tsunami if you do not have an acceptable weapon in-hand.

When set, Icutu Zarahenla will now continue to be used even after TM is locked, so long as Empathy isn't locked.
Fixed a bug related to item dropping sub properly transitioning to lowering the item instead when needed.
Spells with special variables now have the same protections against "stuck variables" in Genie that regular buffs do.  Affected spells - Eillies Cry, Misdirection, Osrel Meraud, Absolution, Cure Disease, Heal, Icutu Zarahenla, Piercing Gaze, Rite of Grace, Siphon Vitality.


07/31/20
Updated Scripts: train, library, kill
Re-added "devotion" option to main Train.cmd menu.  This runs through devotion routines for Clerics for out-of-combat use.
Added rock troll speech to whitelist.
Added Peri'el, Hav'roth, and Ushnish text to prayer sub.
Commune detection now no longer occurs if you're not set to use any communes.
Whitelisted Ushnish and Peri'el prayer speech.
LocksmithBox, Alamanc, Tarantula, Textbook, and Compendium functions now will no longer fire if you are currently aiming in order to avoid wasting time, as having an item in your left hand will kill the aiming.
Fixed a few bugs with DualLoad, generally improved the code.
DualLoad now turns off the variable and alerts you if you don't have enough skill to use it.
More polishing of item handling subs.  Should be invisible except that the script is now more tolerant to commands that timeout.  This is an ongoing process.


07/26/20
Updated Scripts: train, library, set
New Variables = ExpAccuracy and ExpDamage.  These will attempt to maintain the Accuracy and Damage expertise buffs, respectively.  They will attempt to fire regardless of whether you are locked in Expertise.

Tactics sub should now check after fully analyzing a creature to see if it is locked in tactics and if so to proceed with normal maneuver choosing mechanics instead of the tactics maneuver.
General code improvements made to tactics/expertise sub.
Added missing "Your desire to prepare this offensive spell suddenly slips away." messaging to PREP sub.
Fixed a bug in how the decision was made to use the harvest ritual that would cause it to be used less often than it should.
Rite of Grace now can cast in the buffing portion of the script if RiteofGrace is set to YES, and is in top priority.
Cyclic releasing sub is now much more strict about when it will allow a cyclic to be released when you are a Necromancer with NecroSafety and RiteofGrace set to YES.
Fixed a bug that caused invisibility spells not to be properly released after burgling.


07/21/20
Updated Scripts: train, library, set
New variable - NecroState, SiphonVitNum.  Options are unsullied, forsaken, and redeemed.  Defaults to unsullied.  If set to forsaken, automatically disables autopath functionality.  SiphonVit variables now work for all Necromancers, and will act accordingly based on the state you're in.  SiphonVitNum is the health threshold to cast SV if you're a non-redeemed Necromancer.

Some bugfixes for stability to burgling.
Fixed an issue with BurgleEOTB variable.
Fixed a bug with SiphonVitPrepMana default value.
Fixed a bug with an interaction between RoGCycle and NecroSafety protections that could cause an endless Perc loop.


07/20/20
Updated Scripts: train, library, set
New variable - InstrumentAssess.  Governs assessing instruments while playing.  This used to be part of the Appraise variable, but has been split off.  Defaults to YES.
Added Solace as a valid buff.

Fixed a bug in variable defaults for Recite and Dance variables.
IZ, SV, and DebilAssist now require the monstercount in the room to be > 0 to trigger and can no longer trigger during buffing only functions.



07/09/20
Updated Scripts: train, library, set
Added new variables - SiphonVit, SiphonVitPrepMana, SiphonVitAddMana.  These are intended to be used only in concert with Emuin's Candlelight, and are labled that way in Set.cmd.  Setting SiphonVit to yes will have the script attempt to cast SV in priority before other training spells if SV is not detected as a buff.
Fixed a bug with EMC detection.


07/08/20
Updated Scripts: train, library, set, kill, p
The IZTouch variable being on will now cause IZ to be cast and will turn all other cyclic use off.  IZ should be cast via this variable now, not through the CycTM section.  There is a new variable, IZPrepMana to determine what this spell is cast at.
Added all Dragon Priest critters to the critter list.  Added Dragon Priest assassin speech to the whitelist.
Upkeep will now be triggered when you get the message "You are in no condition to do that."
Added EMC to valid buffs and added proper cast messaging.
Added EMC, Solace, and RoF to P.cmd.

Fixed a bug with BugoutonBleed that would cause a script halt.
Fixed a few bugs with Kill.cmd related to the item handling updates that caused a script halt.
Bugfixes to wand buff maintenance for NMU's to prevent an issue where when the script checks to see if the spell needs to be reapplied and the last one hadn't quite worn off yet, and the script then thinks that the wand has been reactivated.
Fixed a bug with NMU detection of MEF for wand usage.
Wand invoking sub now correctly recognizes when you were unable to invoke a wand due to injuries.


06/30/20
Updated Scripts: train, library, set
Began thorough code review of Library.cmd.  In an effort to combat issues involving the script halting when there is a momentary disconnect, or when a single command fails to go through, there will now be new logic for sub timeouts when no valid response is ever received from the game and alerts to go with them.  Subs are being reorganized, edited and sometimes rewritten.  So far only item-handling subs have been affected.  This should be invisible unless it triggers one of the alerts which would have previously resulted in a script halt.  This will be an ongiong process.

Cleaned up code for script start, making it so that certain logic is only run when necessary.  This should make script startup slightly faster and reduce the overall variable load.
Added two different strings of missing test to PUTITEM sub to prevent a script halt if the item is too long to go in the container.
Burgling now will attempt to drop an item if it steals it but the stow fails for whatever reason.

IZMinMana variable has been removed in favor of a new variable, IZTimer.  This sets the minimum amount of time that can pass before the script will attempt to touch with IZ again.  This seems to be a far more effective way to throttle it from using up all of your mana.  Default is 30 seconds.
IZ now obeys the standard MinMana variable.
IZ Touching logic has now been moved to the main spellcasting logic, so it should touch in a much more prompt manner.
Self-healing via Heal now has a 60 second timer on it in order to prevent recasting of the spell before the script understands that the spell is active.  Due to the way the spell works now, it shouldn't need recasting more frequently than 60 seconds even if you're gravely wounded.
Self-healing via Heal now obeys the MinMana variable.

Fixed a bug that could cause offensive stance to remain at 0% after returning from MoveTrain.
Khri Crash logic now is less annoying, only alerting you when concentration is 10% or below AND going down.


06/19/20
Updated Scripts: train, library, set
RELCYCLIC sub now checks to see if you are a Necromancer with NecroSafety on before releasing the cyclic.
Refinements to logic for how MoveTrain prepares to move.
Fixed several bugs related to NecroWhiteList.  To be clear, you should never have to include the person's titles in this variable.  It should just work with the names.  If it ever doesn't work with the names, it means that the functions are not properly scrubbing titles from the name string and something needs to be fixed.
Fixed a bug on a match that could have Thieves sometimes attempt magical acts that they can't do.
Greatly improved logic for scrubbing post strings from players in the room string, thus improving NecroWhiteList's functioning.
When NecroSafety and RiteofGrace are both set to YES, other cyclic use will be disabled in the script.
Fixed a bug with variable setting for NecroWhiteList in Set.cmd.


06/08/20
Updated Scripts: train, library, set
New variable - TreasureAlerts.  Set to YES by default.  When enabled, it will alert you when you've found one of the various items you're set to keep from loot - treasure maps, gweth stone, scrolls, or items on the MiscKeepList variable.
New Variable - KillAfterLock.  This lets the script continue killing things even after all weapons are locked.  This only works in the EvenTrain mode of weapon training, as fixing the other mode would require completely rewriting that section, and I don't think anyone is currently using it.  This variable only displays if EvenTrain is set to YES.  Note that this currently only works on weapons, but I plan on expanding it to TM as well.

Many bugfixes to how MiscKeepList variable is error checked and collects items.  The correct list to collect the book parts is, "crumpled page|singed page|book spine|shattered bloodlock|front cover".  It's now working well enough that I've collected a full book's worth.
Checking for loot now occurs whenever the script believes it should check for dead things, not just when a dead body is found.  This should result in loot being picked up more quickly.
Burgle now properly checks to see if RF and EOTB are already up before casting them.
MoveTrain now goes to sleep before moving into and out of combat.  It probably won't save that much time, but it should help if, for example, movement gets disrupted while traveling.
MoveTrain no longer checks burgle recall every cycle through the loop when training both performance and burgling.


05/25/20
Updated Scripts: train, library, set, kill
New variable - IZTouch.  When you have IZ set as your cyclic TM spell, this variable will make you touch the target you're facing, following all existing rules about locking TM.  It currently doesn't care about whether or not you're learning Empathy from it, which may change as I play around with it more.  When it can fire is based on the IZMinMana variable.  It follows all existing rules for AvoidShock.
New variable - KhriTerrify.  Uses Khri Terrify while combat training.
New variables - BurgleEOTB and BurgleRF for Necromancers and Moon Mages, respectively.  There are no mana variables, as min prep gets the job done just fine with burgling being so quick.  BurgleEOTBDelay and BurgleRFDelay controls how many seconds the script waits after prepping the min prep to cast.
Added PVP alerts for ranger companions interacting with you.

Fixed a bug that would prevent AutoUpkeep on Burden from working properly.
Added alerts for deeper levels of empathic shock.
Added alerts to alert you when you have gone into total empathic shock.
Added regex to selling subs that should hopefully make them work with any pawnshop.
Added missing text for dropping certain types of blankets to fix a script halt with burgling.
Added missing text for invalid pawn item to Hib pawnshop.
Tweaked repair subs to prevent halting inside of Ylono's repair shop due to a mapper issue in one of the Shard zones.
Numerous bugfixes to magic use in kill script.


05/13/20
Updated Scripts: train, library
Added missing messaging to PUTITEM sub to prevent issues with burgle not having enough space left to stow an item.
Added Xala'shar to non-skinnable monster list.
Added Adan'f sorcerers and blademasters to the skinnable monster list.
Fixed issue where non-combat version of Summoning could be triggered for non-WM's.
Perceive and Release subs specifically changed to exclude Barbarians and Thieves to avoid pointless commands.
Added missing messaging to BurglePawn subs for Crossing and Shard.  These should be working right now.  Haven and Hib pawnshop variables are in, but there is probably missing text for both that I haven't collected yet.  Only use this function if you want to help me test it.


05/09/20
Updated Scripts: train, library, set
Added some missing messaging to Face sub to prevent a script halt.
Fixed regex for scroll acquisition so that the script won't hang when there are pages of parchment in the room.
BurglePawn will pawn your ill-gotten goods if a pawnshop is in the area.  Pawnshop data added currently for Crossing, Shard, Hib.  Still in testing and highly likely to hang.
BurgleKeepList variable added.


05/07/20
Updated Scripts: train, library, set, p

New Features
New variable - MiscKeepItems.  A list formatted variable for various misc items dropped by critters that you want to keep which don't have their own dedicated variable.
Added upkeep services to Ilaya Taipa: bank, furrier, gem pouches.
Added upkeep services to Boar Clan: bank, vault, furrier, leather repair.

MOVETRAIN heading added to Set.cmd, and PerformCombat variables moved to that heading.  Eventually, this will be where the variables are for a number of different options for leaving combat and returning.
New variable - MoveTrain.  This globally turns on and off all MoveTrain related functions.  Renamed PerformCombat to MovePerform, renamed PerformCombatRoom to MoveTrainRoom.  These variables will need to be reset by anyone who used them in the past.
Movement variables for MoveTrain - MTTravel, MTTravelDest, MTMove, MTMoveList, MTReturnTravel, MTReturnTraveldest, MTReturnMove, MTReturnMoveList
MoveBurgle - Allows you to move out of combat and Burgle.
MovePerform - Allows you to move out of combat and train Performance.

Burgle is now fully functional and can be activated by using .train burgle and by setting MoveBurgle and MoveTrain to YES.  Burgle variables are under NONCOMBAT in Set.  I recommend running it manually a few times until you feel confident that everything is working properly with your character.  Currently it only uses Thief buffs.  That will change in the future, but getting this much working alone was a huge undertaking.
New Variables: 
BurgleTool - pick, rope, or both, which chooses tool based on learningrates.
BurgleRopeItem, BurglePickItem, BurglePickWorn - rope item, lockpick item, and if it's worn. 
BurgleMaxGrabs - Max number of theft attempts to make. 0 will have it immediately leave the house.  Default is 6.  There is no need to set this low, as the script will automatically escape the house when appropriate.
BurgleLoot - YES keeps the loot. NO drops it


Updates
Finally fixed the last of the bugs (I believe) with cyclic maintenance, including a bug I instruced with the last update that would cause issues with cyclic casting that wasn't TM or Debil.
Whitelisted Oath of the Firstborn casting message.
Made upkeep logic more robust in the case that a service the character wants isn't present in the city.
Fixed a bug in AutoUpkeep that would cause it to run the "leaving the room" functions twice if you were using a premium ring.
The script will now alert you in the main window as well as the alert window when it is unable to run due to being in a room where the mapper will lose track of your location.
Added "that is sleeping" text to monster parser sub in order to properly process creatures that have been affected by Nissa's Binding for Empath target selection.
Added ice adders to the list of skinnable undead, and included custom code to make it actually skin them since they turn into an ice-covered adder skeleton which appears dead when killed.
Added telga orek to the list of non-skinnable undead.
Steal script variables removed from Set.cmd.  Burgle is the new hotness.
Fixed a bug with variable setting function for AUMoveVanish.
Fixed a bug that would cause MeditateStaunch never to fire, even if bleeding.
Added missing messaging to Arrange sub to account for someone else attempting to arrange your kill for skins when you wanted to arrange for part.
Added missing messaging for instrument wiping for when you really suck at Performance.
To cut down on variable and trigger proliferation, many guild-specific sections will no longer load if you are not the correct guild.  This should be invisible other than perhaps improving script performance slightly.
Fixed a bug with P.cmd and AD.


4/23/20
Updated Scripts: train, library, set
New variables added to Burgle that are not active yet, as I'm still coding on them - BurgleThiefBin, BurglePawn, BurgleKeepList.
Burgle now reports what your take was.
Fixed start text for meditations.
Fixed missing error checking code for Berserk Tsunami.
Hopefully fixed messaging on Berserk Tornado.


04/22/20
Updated Scripts: train, library, set
New Features
New varible heading - LOOT.  Loot section has had all loot, skinning, and treasure-related variables moved underneath it.
NoLoot variable has been changed to Skinning, to more accurately reflect what it does in the script.  It is set to YES by default.
Barbarian berserks Cyclone, Earthquake, Flashflood, Landslide, Tornado, Tsunami, Volcano, and Wildfire added.
Barbarian meditations Bastion, Contemplation, Staunch, and Tenacity have been added.  Staunch is conditional, firing only when you're bleeding.

Updates
Cyclic releasing subs now has some extra checks to make sure cyclic variables are set properly.
Release all sub now has extra checks to make sure cyclic variables are set properly and now calls the spellcasting variable reset sub.
Minor changes to cyclic logic to make it less likely to sit idle if no cyclic is currently set to be running, but the next cyclic check time has not happened yet.
Bugfix to cyclic name matching.
Burgle now wakes you up automatically so that you actually learn from the activity.


04/13/20
Updated Scripts: train, library, set, p
Fixed several longstanding bugs where due to variable mismatches the script would fail to recognize when a cyclic had been taken down by unexpected means and fail to reapply it.
Fixed some problems with several internal cyclic spell variables.
Improved variable checking for cyclic spell name variables in set.cmd
Bugout now puts the character to sleep and pauses RPA's, just as upkeep does.
Bugout now will only trigger during combat training.
Fixed a bug that would prevent TM and Debil cyclics from reapplying after returning to combat from playing an instrument.
Bugfixes and improvements to p.cmd and spell matches.


04/10/20
Updated Scripts: train, library, astral
Updates
Fixed a mistake with the new archietecture changes that borked training spellcasting for augmemtation, util, and warding using regular spells after the first cast, but did not affect anything else.
Fixed a bug that could cause TM not to fully lock under some configurations.
Spell prepping is now performed more quickly after the decision is made.
Fixed some bugs with astral.cmd caused by the new architecture changes.
Stand sub is now able to handle being asked to stand when you are unconscious.


04/09/20
Updated Scripts: train, library, set, custom, p, kill
Major Updates
Burgle is in, and can be tested via .train burgle.  The relevant variables to make it work, BurgleContainer (the place you put your loot), BurgleTool (rope, lockpick, or ring), BurgleToolItem, and BurgleLoot, are under the Upkeep section.  BurgleLoot will decide whether or not to keep loot or drop it.  Pawning or Thief Binning your loot is not in yet.  Buffs for guilds other than Thief are not yet in, but if you start out invisible the script will use it.  Basic arrest alerts are in, but there is a lot more work intended for this section.  I recommend watching this section while it runs, as it is a work in progress, though it should not get you arrested barring something I haven't seen happening.

Minor architectural changes have been made to the scripts that affects custom.cmd, as well as kill.cmd and p.cmd.  The internal "incombat" variable has been renamed to "scriptmode", with the following options: ScriptMode -1 = Help, ScriptMode 0 = NonCombat, ScriptMode 1 = Combat, ScriptMode 2 = BUffing, ScriptMode 3 = Upkeep, ScriptMode 4 = Burgle.  Settings in custom.cmd where the incombat variable was used will need to be renamed.  A new custom.cmd will be pushed out with this update with better examples to help you better use custom.cmd.

Lots of script errors squashed in p.cmd and kill.cmd, for those of you with the more restrictive script alerts on in Genie.  If these scripts weren't usable by you before because of that, they now should be.

Steal.cmd is removed from the repository, as I'm not planning on supporting it any longer.  Burgling is better.

New Features
SorceryAlerts is a new variable set to YES by default.  It will attempt to alert you when you have a sorcerous backlash.  I am still collecting these, so the list may be incomplete.  If you have one and it doesn't alert you, let me know.
CollectMaps is a new variable set to YES by default.  It will automatically store treasure maps that you find.
Absolution and AbsolutionPrepMana are now variables for Empaths under the guild section.  When set to YES, Absolution will be maintained as a buff so long as the script detects undead creatures in the room.  Please alert me if you find there are creatures this does not work properly on.
Increased support for Guardian Spirit.  After casting in the combat script, the alfar will automatically be commanded to be aggressive, and the script is now able to properly handle it as a cyclic.
Summoning training has been revamped.  Now, the Summoning variable controls whether any summoning training at all is done.  Pathway learning is controlled with the Pathway and PathwayType variables.  The SummonWeapon variable has been added to allow training using summoned weapons.  These weapons are destroyed as soon as they are created - no support exists at this time for using them to fight with (mostly because it's a bad idea).  All WM's should revisit the guild variables before running the script again or Summoning may not be trained.

Updates and Fixes
Fixed a bug with autoupkeep that could cause it to try to upkeep right after returning if the health triggers dipped low enough DURING upkeep that it would have triggered autoupkeep if you were in combat.
Bugfixes on messaging when attempting to use a premium ring for upkeep, but the ring timer is not yet up.
Updated premium ring timer triggers to new messaging.
BugoutCollectAmmo variable is removed for simplification.  That logic now depends on the base CollectAmmo variable, on the logic that the LEAVEROOM function is improved, and if you care about saving your ammo, you probably care about it more than dying.
Whitelisted out some more sanowret messaging from SpeechAlerts.
Fixed a bug that could cause the nonviolent stealth logic to fire on rock guardians, even though they are not critters that shock you.


03/22/20
Updated Scripts: train, library
Item Handling Updates
Ammo collection and thrown weapon collection logic upon leaving a room made significantly more robust.
Ammo collection and thrown weapon collection logic is moved to the STATUSCHECK function.  This means it will now be processed after every action.  If you are hunting alongside someone else, please make sure your ammo variables are as specific as possible - "crossbow bolt" instead of "bolt".
Improved logic written to accurately determine if a weapon is currently on your training list.  This is now used in several places to not grab ammo that you're not using.
Ammo loading sub is now able to swap hands if it tries to get ammo and it lands in the wrong hand.
GETITEM sub will now stow only the item in the left hand when it tries to get an item when your hands are full.

Movement Updates
Adjustments made to room leaving function to make it more robust.  Thrown and ammo gathering moved to be earlier in the function before any attempt at retreating occurs.
Stow feet function now will attempt to stow what's in your hands if you do not have any free hands.
As a last ditch effort, the script will now try to stow what's at your feet in a trigger if you attempt to move and are blocked by having an item at your feet.
Retreat/flee function made more robust and self-contained.  Fixed a bug in it that could cause it to attempt to flee under some circumstances even if it had not exhausted the number of attempts to retreat first.

Misc Updates
GM Alerts now display more information in the output window about what text they flagged.
Improvements and bugfixes made to STATUSCHECK to prevent post-upkeep buffing from doing things that it shouldn't.
Extra checks added to upkeep to make sure bundling ropes and gem pouches are properly stowed.


03/17/20
Updated Scripts: train, library
Added some additional checks try to ensure that combat cyclics are not carried over to Performing from Combat and vice versa when using PerformCombat.
Fixed a bug with PostBuffPerc error checking causing the variable not to be set properly to the default NO if it was blank.
Selling bundles in Fang Cove will now wait and try again if it happens to sell during the night/day shift change.
The script will now always attempt to stow any items in your at-feet slot before leaving a room.
Various additional fixes to instrument maintenance to make sure it doesn't get tripped up.


03/14/20
Updated Scripts: library
Instrument maintenance functions are now able to swap the instrument from left to right hand, if necessary.


03/14/20
Updated Scripts: train, library
Updates
Added a final upkeep room for buffing and foraging in Mer'Kresh.  Added placeholder end room to Aesry, Ratha, Leth, and Muspar'i (room 1) that will avoid script halts until I can get around to actually going there and finding a good room.
Added missing text to avoid a script halt for bundle selling.
Fixed a bug that could cause cyclic Debil and TM spells to not be properly maintained.
Added missing messages to Whistle Piercing for when the Bard has no mojo.
Changed the location of the goupkeep variable setting in the script, as the new buffing after upkeep was sometimes causing the script to attempt to go into upkeep while it was already in upkeep.
Fixed a typo that caused instrument cleaning to never, ever happen.
The script will now attempt to dry instruments whenever it would otherwise clean an instrument.
PerformCombat will now automatically attempt to clean and dry instruments at the beginning and end of each performance session.


03/09/20
Updated Scripts: train, library, set
New Features
Upkeep will now check your buffs and re-apply any that have fallen off before returning to combat.  This will NOT occur, however, if upkeep is triggered via the command line - .train upkeep
PerformCombat will now check your buffs and re-apply any that have fallen off before returning to combat.
Wand usage is now enabled for Thieves and Barbarians.  Only the Mental Focus spell is currently valid for these guilds.  If anyone thinks of any other spells they'd want to run for a Thief or Barb for training purposes let me know.  Since those guilds cannot detect spells being on them through normal means, custom coding must be put in place to detect if the spell is already up.

Updates
Partially rewrote how the .train buff and .train upkeep code works so that the buffing code can be called from other portions of the script.  These changes should be invisible, but let me know if there are any problems.
Fixed some regex where the script would fail to update your balance properly with certain variations of the balance messaging.
Adjuted regex for gem pouches so that the script can handle full pouches with different short descriptions.
Added missing text to an unlikely failure situation with monster appraisal.
Fixed some regex related to how the script tracks when a creature you're fighting has been killed.  This should make Empaths less likely to get accidentally shocked when fighting in mixed environments, as well as eliminating some situations where the script would not skin a dead creature that you personally killed.
Self-healing for Empaths (Heal, Vit Heal, Cure Disease) is moved up to a higher priority than buffs.
Vit Heal moved to lower priority than Heal (otherwise it will just keep vit healing and never heal the bleeder).
Conditions for triggering Heal and Devour are adjusted slightly to better mesh with the heal-over-time nature of the new spells.
Fixed a bug with Khri Darken that could cause it not to be stopped properly if it's not supposed to be up.
Thief Khri is now triggered in a more timely fashion by being included in the STATUSCHECK sub with the rest of the buffs.
Added missing flee messaging for Thieves and Empaths.


02/29/20
Updated Scripts: train, library, set
New Features
Creature appraisal is now in as an option for Appraisal training.  The new variable, AppraiseTarget, if set to "creature", will appraise creatures on the same timer for Appraisal experience.  If set to "bundle", the default, it will behave as before and appraise your bundle.  On the plus side, appraising creatures does not require retreating, so it will not harm your weapon training as much.  However, it seems to give less experience.  I don't know enough yet to tell you whether this is a good trade or not, so I leave it to you all to test.
Adaptive Curing Heal is in.  When the new variable, ADCHeal is set to "YES" then the script will attempt to cast it as a buff and maintain it, using existing logic.  It is placed in priority below existing buffs.  I don't have the spell to test this directly, but it should be working.  Please let me know if there are issues.

Updates
Advancing sub is now able to stand back up if you are knocked down between the pre-advance checks and the command actually firing.
Failing to come out of hiding due to injuries no longer halts the script and now stands you up immediately.
Failing to come out of hiding due to injuries now resets the heal check timer for Empaths.
Failing to tend a wound now resets the heal check timer for Empaths.
Fixed the Perseverence of Peri'el spell variable in order to prevent repeat casting.
Added blightwater nyads to the undead creatures list.
Squelched lots of blightwater nyad and bloodwood dryad speech from SpeechAlerts.


02/18/20 #2
Updated Scripts: train, library
Several bugfixes to make TM tattoos work properly.


02/18/20
Updated Scripts: train, library, set
Fixed a bug in calling STOWITEM function with instruments, causing it not to stow properly.
Squelched black marble gargoyle speech.
Properly updated Set.cmd to display and allow changes to the variables SpellTMTattoo, LockSmithBoxItem, and re-removed CombatLocksmithBox variable.


02/02/20
Updated Scripts: train, library, set
New Features
SpellTMTattoo variable has been added, allowing tattoo spells to be used as the main TM training spell.
LockSmithBoxItem variable has been added to accomodate different type of locksmithing boxes.
Wand usage is in for MAGIC USERS ONLY.  New variables are WandBuff to decide if it's used, WandNum for the number of wands (1 or 2), WandItem for the wand device, WandStorage for the place where the wands will be stored, and WandSpell for the spell that is being used.  NMU usage will be forthcoming, but I'm still working on it.  They're harder because theyu can't sense the durations.  This was VERY TRICKY to get implemented, but it should be solid now.  Let me know if there are any issues with it not being properly maintained.

Updates
Changed epistemic journal writing function to properly accomodate journals with different nouns.
Added additional code to prevent issues when trying to get an item that is actually tied to your pack.
Improvements to app focus tracking in order to prevent upkeep issues.
Observe commands now include the text "in sky" in order to prevent issues with items in the room.
Bugfix to aiming sub to prevent a rare script halt.
Fang cove time of day detecting added "early morning" to block list for repairing since shops are closed, even though it's not technically at night.
Blood warrior speech removed from SpeechAlert triggers.
CombatLocksmithBox variable has been removed in favor of the LocksmithBox variable controlling use of the locksmithing box in both training modes.
Improvements to STOW subs and item identification and handling for items with special storage locations.


01/12/20
Updated Scripts: train, library
Added checks to stop prepping a spell you were already prepping when leaving a room in order to avoid casting spells in justice areas that shouldn't be cast there.
Additional fixes to dirt stacker handling.
Added cabalists and intercessors to the valid critter list.


01/07/20
Updated Scripts: train, library, set
Anloral pins now use "my" to avoid interacting with water in the room.
Added missing messaging to PUT sub to prevent a script halt when a stacker item was already full.
Adjusted logic for dirt stackers so that it checks if it needs filling before foraging.
StanceSet variable has been renamed StanceMain for clarity, with some additional help text in Set.  If you previously had a value set for StanceSet (as everyone using the script should) this will be imported automatically.
Fixed a bug where no communes would ever fire if MeraudCommune was not set to YES.
Fixed several bugs where the various communes could possibly fire even when the variables were not set for them to be.
Put in a workaround for the tannery in Fang Cove at night causing the automapper to lose track of where it is and halt the script.
Added variables for wand buffs.  Code isn't working yet, so don't use it.  I just wanted to push the rest of the updates.

01/03/20
Updated Scripts: train, library, set
Added Khri Cunning functionality.
Turned on nighttime bundle selling on Fang Cove.
Fixed missing label in for bundle tie pause.
Changed bundle subs to use "my" to prevent issues with a bundle being on the ground.
Observing now will not happen in astrology logic if it thinks it can predict.
If the script is ready to predict but is choosing not to due to too many astrology mindstates it will wait 5 minutes before trying any astrology actions again.


01/02/20
Updated Scripts: train, library, set
New Features
TeachTargetNum, TeachTarget1, TeachTarget2, and TeachTarget3 have been removed as variables in favor of TeachTargets, which is a list of people you're willing to teach, separated by ther | character.
TightBundles, SaveLumpyBundle, and AppraiseLumpyBundle variables have been removed.  They have been replaced with the AppraiseSaveItem and AppraiseSaveItemStorage variables, which represent the type of bundle you want to save for appraisal purposes (tight, lumpy, or none), and the storage container that the bundle is to be put in, which MUST be different from your main storage container if you're using tight bundles for AppSaveItem.  Otherwise too much stuff is trying to happen during the appraisal routines.  From now on, all bundles will be tight bundles UNLESS the script is saving up for a lumpy bundle to appraise and doesn't have one set aside yet.
Upkeep will now forage dirt until the dirt stacker is full if a Cleric has a dirt stacker set and is in a city that I've set an appropriate end room for foraging.
Added upkeep end room to Rossman, Theren, Haven, Crossing, Shard, Hib, Fang Cove, Raven's Point.  This gives the script a specific room to end upkeep in which should be foraging friendly.
Added Eluned and Tamsine commune usage for experience purposes in combat when Meraud Commune isn't enough.  Variables are ElunedCommune and TamsineCommune.  This one has been hard for me to test properly, as keeping Meraud up is more than enough for my Cleric, so let me know if there are issues here.
Emote alerts are now turned off during AutoUpkeep.

Updates
Teaching will no longer waste roundtime on assess teach, or go through teaching logic, if nobody is in the room.
Fixed a timing bug with epistemic journals.
Fixed a bug with a dirt stacker function name.
Eluned commune now makes sure you have free hands before using.
Anloral pin logic now makes sure you have free hands before cleaning the pin.
Vault moving now functions properly if your character is female.
Stowing items in hands when escaping combat is now moved to AFTER escaping for those using premium rings, in order to expedite leaving combat.
Added Cleric ritual shop location and messaging to Shard for upkeep.
Cleaned up some astrology code.
When predicting and getting the full pools message, script should now immediately check for pools to predict on using PREDICT STATE ALL.
Due to Piercing Gaze logic being pre-empted by the newer spell logic, it was likely not being properly applied and thus prediction not happening under many circumstances.  Responsibility for PG casting has been moved to main buff logic, below all of the regular buffs in priority.  The script will now attempt to keep PG up at all times if Astrology is being trained.  This should pose no undue burden on MM's with their mana hax and magic prime attunement.  Variables for PG remain the same - PGPrepMana and PGAddMana.


12/15/19
Updated Scripts: train, library, set
New Features
For those of you who hunt in a way that requires a cyclic to be up at all times to keep you safe (such as a cyclic debil, Aether Cloak, Ghost Shroud, etc), a new variable has been implemented called CyclicPriority.  When set to YES, it will cause cyclic logic to be placed at the top of the priority list for spellcasting, even above regular buffing.
Added new variables - DirtStacker and CommuneEluned.  If either dirt is in your storage, or your dirtstacker has dirt in it, the script will now attempt the Eluned commune when you are out of holy water for the Meraud commune.

Updates
If PremiumRing is set to YES, when you go to upkeep and you're already in Fang Cove the script should now recognize it and not try to use the ring.
PremiumRing subs now properly account for failures of all different types of rings.
PremiumRing failures and timers are now a little more fault tolerant.
Abilities that are used for bugout purposes that are attached to specific guilds, such as MoveWhistle, MoveScream, and MoveVanish are now displayed in the guild section rather than the upkeep section, for clarity.
Incense counting logic has been improved so that it also counts "blessed incense" and "burned incense" in addition to "fragrant incense".
Added shadowling exclamations to whitelist for speech alerts.
Added appropriate trigger for epistemic journals if the time that they can be used in is under an hour.

12/10/19
Updated Scripts: train, library
Fixed a misplaced bracket that caused Panther form to spam "form stop panther".
Form stop sub now forcibly changes SpellTracker variables in order to prevent spamming the stop command because the form stop command doesn't automatically update the SpellTracker window.
Added some missing messaging to Tarantula use to prevent a script halt if you rubbed it with no experience in the skill.

12/09/19
Updated Scripts: train, library, set
New Features
Biomechanical Tarantula use is enabled.  The relevant variables are Tarantula, TarantulaItem (for how to refer to your tarantula, in case you have it altered), TarantulaSkill1, and TarantulaSkill2.  It should be fairly self-explanatory.  Considering that the timer is only 10 minutes, it currently does not wait for the skill pool to fill up to a specific point.  It just uses what it has.
Added Yogi variable for Barbarians to track whether or not you have the Yogi mastery and need to retreat and sit before meditations.  Defaults to NO.
Meditations have been added as valid training types for augmentation and warding.  If Yogi is not set to yes, the script will attempt to retreat and sit before doing them.
Tenacity and Serenity added as valid warding training for Barbarians.
Dual Loading is now available for Barbarians, Rangers, and Thieves using bows and with the appropriate buffs up via the DualLoad variable.
If active, Panther form will now only activate when training stealth, and stealth training will wait for Panther form to be on before it attempts to train.

Updates
Aimed weapon loading sub now uses "my" to specifify your ammo, and uses the ammo name.
Added missing messaging for Meraud commune under Commune Sense to ensure commune is always recognized.
Barbarian ability activations are now folded into StatusCheck sub, just like spellcasting is.  This will make the script check much more often for if any Barbarian forms need to be started or stopped.
Added missing messaging to prevent a script halt when stopping Buffalo form.
Forms, Berserks, and Meditations will now alert you in the AlertWindow if you try to start them and you don't know the ability or you typoed the training name.
Attempting to start a Barbarian form when there are too many forms up will now no longer halt the script and will message your AlertWindow to let you know to investigate.


12/06/19
Updated Scripts: train, library, set
Anloral pins now use "my" to prevent junk on ground interfering.
Pilgrim badges will now still be used, even if they happened to be picked up into the left hand.
Added new triggers to catch different Meraud commune states.
Fixed a bug that would often prevent the script from detecting that the Meraud commune had fallen off.  This would cause the commune to be used correctly the first time, but often fail to re-apply it, causing Theurgy to mostly stop training over longer periods of time.  This seems to be working properly now, and should be a significant experience boost.
Preliminary work done on Tarantula support, including variables, but the code is still switched off until I get it working properly.

12/03/19
Updated Scripts: train, library, set
StanceSet is now listed under the Combat section in Set.cmd.
ShieldOnly, ParryOnly, and StanceChange variables have been removed, as the superior way to use stances is to just use a single stance with all 3 defenses.  I don't think anyone was doing this, but if anyone had StanceChange set to NO, you should make sure StanceSet is set properly to your main stance.

The useless gweth stones should now be treated as normal gems and stored properly.
Epistemic journal now tracks how long it has before it can be used again, and will not simply decide to stop using it for the duration of the script just because it wasn't available when it first tried.
Added missing epistemic journal messaging to prevent a script halt.
If there is no holy water in the WaterContainer, Meraud commune will stop attempting gracefully and will alert you while turning off the variable for the duration of the script.  Plans to add water creation to upkeep later.
Bundle selling is now better at knowing when it can't do that in Fang Cove because the shops are closed.
Failure to sell bundles (such as when shops are closed in Fang Cove) has been made more fault tolerant.
Fixed a bug with bundle selling movement.
App Focus in upkeep should now recognize when you've already got an app focus completed and not hang forever waiting for a breakthrough if you do two upkeeps close together.
Ammo getting and loading now uses 'my' to avoid the issue of trying to pull the ammo from the critter and failing.
Manipulate formerly looked to see if a critter was on the "ritual critters" list, but also not on the undead list to determine if a target was valid to manipulate.  It now checks to make sure that the target is not on the construct list to avoid issues with origami goblins.


11/30/19
Updated Scripts: train, library
Fixed a bug that could cause an infinite repeat of commune sense under some circumstances.
Removed some messaging related to communes that could be spammy.

11/29/19
Updated Scripts: train, library, set, p
New Features
MeraudCommune is now fully functional in combat.
Added Recite and Dance variables.  If set, these Clerical rituals will be performed on a 10 minute timer when the Meraud commune is active.
Pilgrim dadges, Anloral pins, and the Meraud commune will message the AlertWindow when they are used.  Once I'm confident in everything I'll probably remove those.
Incense purchasing added to Riverhaven and Therenborough during Upkeep.
Script will now alert you and turn anloral pin usage off if you explode an anloral pin due to not having the right favors.

Updates
Added a guild-based check on Summoning and Theurgy activities to prevent using them, even if the variable is set.
.Train devotion (noncombat devotion) is disabled pending a rework.
Several bugfixes to cyclic logic.
Added anloral pin variables to Paladin section in Set.
Bugfix to casting CD in P.cmd.
Fixed a bug with recovering repaired metal items in the Theren area.
Several bugfixes to anloral pins.


11/28/19
Updated Scripts: train, library, set
New Features
Theurgy variable has been reworked.  On its own, it no longer causes anything to happen.  If set to yes, it allows other variables related to cleric activity to happen.
Anloral pins will now be used in combat to gain devotion/soul state if the AnloralPin variable is set.  The timer to check on this is 60 minutes, though the pin should only get dirty enough to clean once per day.
New Variable - Incense.  Listed under the Upkeep section for Clerics, this variable will purchase incense until you have the number in the variable during upkeep.

Updates
Fixed a bug relating to multiple cyclics and what happens when one locks.
Clerics now have a 60 minute timer instead of a 30 minute timer for pilgrim badges (because why would Clerics and Paladins have the same timer?)
Fixed a bug where pilgrim badges would recall afterwards, regardless of if recall was off timer.


11/27/19
Updated Scripts: train, library
Epistemic Journals now stow anything in the hands before use, as they require a free hand.
While chasing down a bug with HYH, I discovered my entire cyclic logic was both ancient and garbage.  Rewrote cyclic logic.  It now properly recognizes whether TMDBPrior is set (as opposed to it mostly working right by chance before), and now correctly picks the cyclic with the lowest learningrate.  I've done some testing, and everything looks good, but if you use multiple cyclics for training and things are behavior weirdly now, let me know.
HYH Should no longer recast itself again and again.
Fixed an issue with FOU which caused it to use the cast command twice.
Fixed an issue when using DR for debilitation that could cause it not to be targeted properly (it's an odd spell).

11/25/19
Updated Scripts: train, library, set
Merged all upkeep-related movement into one sub.  This should be invisible, but supports further upgrades.  Let me know if Upkeep hangs at any point.
Fixed several issues related to reporting of vaulting gem pouches and bundles after upkeep is complete.
Several bugfixes to Epistemic Journal use.
Bugfix to AlmancAlerts not showing when a nonstandard almanac is used.
Bugfix to variable setting for Stealing variables.


11/24/19
Updated Scripts: train, library, set, astral, p, preptimer, kill, goto
Main Script New Features
Almanacs can now have the item name set manually for altered almanacs via the AlmanacItem variable.
Epistemic Journals are now in, with the EJournal, EJournalItem, and EJournalStates.  The Journal will be used when your total number of mindstates is at least the number of EJournalStates.  Default is 600.
Pilgrim's Badges will now be used in combat for both Clerics and Paladins if PilgrimBadge is set to yes.  PilgrimBadgeItem defines the item name for the script to interact with it.  This is on a 31 minute timer.  For now, it alerts you in your AlertWindow while I monitor it.  I'll probably eventually silence that.
Added goto.cmd, a new goto script that is designed to be more fault-tolerant than Genie's default #goto command, and uses my movement subs.  Usage is identical to #goto, only you use .goto instead.
Removed sgags.cmd and sgags.cfg from the repository, as I'm no longer maintaining them.

Updates
Squelches for Crossing-Leth ferry speech have been added to SpeechAlerts.
Minor tweaks to move sub to avoid a potential unnecessary delay and to alert you if you try to move but Genie doesn't know where you are (which means automapper won't work).
Astral travel script now awakens you before going so that you get that sweet Astrology experience.

Kill Script
Target selection has been rewritten.  Script now assumes that if you use no additional arguments that you are intending to kill any creatures around you.  Specifying a target should make your attacks more selective.
Offensive actions should now only be attempted if there is a valid target in the room to prevent silly spamming.
New variable - KillRetreat.  If enabled, script will do its best to keep you ad missile range.
If KillTM and KillDB are both set, the script will now alternate between your TM and Debil spell.
Magnetic Ballista functionality has been added to Kill script via the MagneticBallista, MABPrepMana, and MABAddMana variables.
BGDBCombo variable, which is about using Kill to debiliate, then unload BG then DB on an opponent, has been removed until I have the chance to get it working properly.

P Script
Magnetic Ballista now automatically casts Reinforce Stone to lengthen duration and rubs the ballista to make it not unbalance the area when cast with P.cmd.
Substratum now is abbreviated to "subs" in P.cmd.

Preptimer
Fixed SMH spell timing in PrepTimer.
PrepTimer now properly restarts the timer if your existing target was killed and you start targeting again without re-prepping the spell.


11/07/19
Updated Scripts: train, library, p
Fixed some bugs related to alerts and burden and bleeding checking firing when they shouldn't.
Fixed a bug with P.cmd that caused some spells to not properly add mana when there was only 1 argument.
Added text to almanc studying to prevent a script halt.

10/22/19
Updated Scripts: train, library, set, steal
New Features
Script will now alert you and refuse to run if Genie is not able to figure out the room you're hunting in on the map and you're attempting to use Bugout or AutoUpkeep.  This is more stringent if you're using Premium Rings, as using them to return requires the room to be figured out from scratch.  This prevents a false sense of security and script hangs.  If you're getting this error message, try changing rooms.
Emote alerts now attempt to notify you about what sort of remote triggered it.
New variable - AUOnNerves.  If set to YES, AutoUpkeep will start if your nerves get down to "some severe twitching".
New variable - AUOnBurden and AUBurdenNum.  AutoUpkeep will start if your burden gets up to the level specified in AuBurdenNum, which rates burden states 1-11, in increasing order of severity.

Fixes
Atmo speech on the galley between Mer'Kresh and M'Riss should be excluded from speechalert messaging now.
A new method is now used to reacquire the map location when using Premium Rings for AutoUpkeep.  This should prevent some issues of losing the room number when returning from Fang Cove to hunting.
Added missing message to weapon wielding to prevent a script hang when hand is missing.  This messaging now triggers AutoUpkeep.
Added missing messaging to wield sub to prevent a script halt.
Fixed a bug with rope coiling.
Fixed a bug with the steal script not properly binning towels from the bathhouse.


9/26/19
Updated Scripts: train, library, set, steal
New Features
Added the Steal script.  Variables are under .set display other.  This is my first version of it, and it only works in Crossing at the moment, so think of it as beta testing for the moment if you want to use it.  From Set: NOTE! Armor variables must be properly set for armor removal.  StealContainer must contain no other items because the entire contents will be dumped in the donation bin at the end!  Valid shops are: orielda|talmai|chizili|mauriga|falken|berolt|berolt2|orem|grisgonda1|grisgonda2|milgrym|tembeg|marcipur|ragge|bard|durantine|brisson1|brisson2.  "2" shops are always backroom shops.
GemVault variable has been added to Upkeep.  If set to YES, tied gem pouches in your storage container will be vaulted, just like the BundleVault variable works.
GemPouches variable has been added to Upkeep.  If set to a number greater than 0, it will make sure you have that many gem pouches.  Works just like BundleRope variable.
Added support for AutoUpkeep on Aesry.
AutoUpkeep now has the capability to fire if you have missing hands.  If this happens and it DOESN'T fire, please collect the messaging and send it to me.

Fixes
Added support for the "You drape..." wear message to prevent a script halt.
Added support for coiling rope to prevent a potential script halt.
Added handling for removing an item but having no hands free to prevent a potential script halt.
Added failed cast messaging for IOTS to prevent a potential script halt.


9/06/19
Updated Scripts: train, library, set, kill

Backfire alerts will now show which spell backfired.
New Variable - LootAllDead.  This will automatically loot any dead creatures in the room as soon as the script finds them.  This is very much NOT group-hunting friendly, and will result in increased roundtime and pissed off hunting partners, so only use it when hunting alone.  Defaults to off.
Upkeep is now able to negotiate the galley between Mer'kresh and M'riss.  To use it to run upkeep on Kresh your variables will need to look something like this:

AUTravel: NO
AUMOve: YES
AUMoveList: 151|galley
AUReturnTravel: NO 
AUReturnMove: YES
AUReturnMoveList: 113|galley|start

This feature seems to work in my testing, but let me know if there are any issues, particularly related to the maze-like nature of the dillos area.

Fixes
Script will now check for dead critters once every minute from Manipulate or TM Cyclics if either of those are enabled.  There was a high likelihood that those creatures were just being left to rot before.
Premium ring logic is now more robust for retreating if the original retreat isn't effective.
Setting PremiumRing to YES now automatically sets AUTravel, AUMove, AUReturnTravel, and AUReturnMove to NO.  They are mutually exclusive.
Reordered some of the procedures in room leaving.  Logic on whether it needs to retrieve a thrown weapon before leaving is now more robust.
Added warklin maulers to the list of valid creatures, which they somehow were not part of.
Significant refinements to facing and target selection mechanics.  Should make shock significantly less likely and spamming of commands when no critters are present eliminated.
Reworked spell releasing subs to be less prone to failing to register the appropriate messaging.  Also, it is no longer possible for the script to halt here, as it's automatically forwarded out after 2.5 seconds.
Fixed a bug with a missing sub name in Empath-related facing.
Fixed a small bug in Set which resulted in SpellDBAddMana being displayed twice.
Kill now properly loads the tktitem variable to allow TKT and TKS to be used properly.


8/23/19
Updated Scripts: train, library
Small bugfix to make sure offensive stance goes back to normal when re-entering combat from upkeep.

8/23/19
Updated Scripts: train, library, set, astral

New
A new variable has been added - BugoutOnBleed.  If set to YES, the script will bugout when bleeding.  If it is turned on at the same time that AUOnBleed and AutoUpkeep are turned on, then BugoutOnBleed will be turned off in order to prevent conflicts.
A new variable has been added - BugoutCollectAmmo.  If set to YES, the script will run a pass to collect ammo before bugging out.  Use at your own risk, as it may result in you dying if your BugoutNum is set too low!
When leaving a room as part of AutoUpkeep or PerformCombat the script will now run another pass to try to collect any ammo you might have left behind if CollectAmmo is set to YES.

Fixes
Facing code has been made more fault tolerant script-wide to prevent issues of attempting to face something, finding nothing to face, and then trying once more to do the same thing, creating a loop.  Script should instead move on to other activities.
All instances of leaving a room you're hunting in (CombatPerform, Bugout, or Upkeep) now are all run through the same code for the sake of consistency, as opposed to each doing it their own unique way.  Khri Vanish, Whistle Piercing, and Scream Defiance now work for all three types of room leaving.  AUMoveVanish, AUMoveScream, and AUMoveWhistle are renamed to MoveVanish, MoveScream, and MoveWhistle as part of this because they now apply to any time you're moving out of combat.  Please re-adjust the variables appropriately.
Bugout variables have been moved to the Upkeep section in Set.
Astral travel now refuses to run and messages you if you attempt to start it with an object lying at your feet, which will prevent proper movement in the ways.  It will also do the same if you're not a Moon Mage (Astral script does not support guides at this point).


8/21/19
Updated Scripts: train, library, set

New
Braiding functions and variables have been removed, as they're no longer really relevant.
Added Astral Travel variables to the Other section in Set.
Default variable checking has been vastly improved.  There should be no more unset variables in Set.  This is done automatically, so first time setup is no longer necessary, as all variables are now validated automatically on script load.  As part of this Set has been slightly reorganized for readability and making sense, and less "variable hiding" is done, so some sections might appear a bit longer.  Let me know if you have any issues with variables not being able to be changed.

Fixes
Added missing messaging for Vitality Healing to prevent a script halt.
Added a look command to every Empath AvoidShock target selecting routine to prevent bad data from Genie from informing the target selection.
Fixed a bug that caused infection to not be properly detected for purposes of Empath self-healing.
Turned on an additional message for infection detection: "Your wounds are infected."
Made premium ring timer for AutoUpkeep more accurate.
Fixed a bug with Shard autoupkeep and properly finding the bundle selling location.
Added messaging to the alerts window if textbook use is turned off due to an invalid entry.
Fixed a logic bug that could cause non-metal weapons to never get repaired if they were later in the repair list than a metal weapon that was already being repaired.


7/30/19
Updated Scripts: train, library, set, kill
New Features
Arranging will no longer happen if Skinning is at 30 mindstates or greater unless ArrangeForPart is set to YES, in which case it will arrange just once.  This is because arranging provides no extra monetary value and it uses up time that could be spent on other things.
BG can now be used as a TM spell in Kill.  This allows combo use of BG and DB.  It does NOT wait for debilitation to fire first and then unload - that function is reserved for the BGDBCombo variable, which is not fully operational yet.

Bugfixes
Fixed a bug in Set that prevented AUMoveVanish, AUMoveWhistle, and AUMoveScream from being displayed properly.
Fixed a bug that caused Empaths to check health too often.
Fixed a very specific bug that could cause Empaths to get a script halt if tactics tried to make a brawling attack do something it couldn't do and AvoidShock was on.
Fixed a bug with Empath target selection that could cause undead creatures with nouns that matched non-undead creatures to be targeted for manipuilation.
Fixed a bug with item removal function that could cause a script halt if the item was already in your hand.
Fixed a bug that caused some Empath checks to avoid shock to not be working quite as intended.  Added some additional checks to try to make getting shocked even rarer when hunting in an area with creatures that can cause shock.
Fixed a bug that caused the pharness variable not to be set properly.


7/18/19
Updated Scripts: train, library, set, p, kill
New Features
Added AUMoveWhistle, AUMoveScream, AUMoveVanish - if set to yes, the script will attempt to use Whistle Piercing, Scream Defiance, and Khri Vanish, respectively, when engaging AutoUpkeep for retreating purposes.
Script now attempts to release IOTS before casting in order to avoid accidental death.
All Paladin and Ranger spells added to P script.  This makes the script operational to cast any spell in the game.
Kill script is active on a basic level!  Many new variables.  It works with weapon use, tm, debil, and cyclics (as well as Dragon's Breath for WM's) to kill players or enemies.  Syntax is .kill or .kill target.  Variables are under ".set display other".  This is in testing, so you probably shouldn't rely on it in PvP yet, but I would appreciate it being tested on mobs.

Updates
Completely rewrote cambrinth and harness math.  Charges and harnessescan now be split as many times as is needed to stay under the ChargeMax and HarnessMax variables, respectively.  Both now have a minimum setting of 5, which should accomodate even brand new characters.  Otherwise you should see no differences.  This has been tested thoroughly.
Cambrinth usage routines now keep track of how much mana should be used on each device and will now invoke only the amount necessary.  This should prevent backfires in the case of the device already being charged at script start.
Removed DebugMessages variable and functionality, as it was no longer needed.
Removed RapidCast variable.  All casting now follows the RapidCast methodology.  Default MinMana value, if not set, is now 30.  MinMana can no longer be assigned to a value less than 10.
Removed KillingOnly variable and functionality.  Automated killing is being moved to the new Kill.cmd script.
Moved NonComDelay variable display to the NonCombat section.

Bugfixes
Excluded more shadowling messaging, Paladin casting, and Janitor messaging from Speech Alerts.
Updated regex of all subs to be properly more selective for the "...wait" message.
Fixed a bug with Khri Strike and Steady that prevented them from properly firing.
Added another version of the messaging for trying to get a bolt out of a critter to prevent a script halt.
Modified Release Cyclic function to prevent potential script hangs.
Several bugfixes to P.cmd with regard to mana handling that were unique to that script.


6/20/19
Updated Scripts: train, library, set

Magic Changes
Modified release functions to accomodate new release mechanics, and did a pass through the code to catch any issues.  Removed any instances where just plain "release" syntax was used for more precise releases or simply "release all".  Release cyclic code is now made vastly more fault tolerant by attempting to release the spell twice - this is intentional, as the mechanics give a different message for every single spell.
Prepping a tattoo while hiding no longer causes a script hang.  It unhides and preps as normal.
Tattoo use is now possible for Debilitation spells.  If SpellDBTattoo is set to YES it will invoke the tattoo to cast the spell instead of prepping.  Just as before, if invoking a tattoo fails, all tattoo variables are turned off and a warning message is displayed.
Fixed a bug that caused the PostBuffPerc setting to perc WAAAY too often.

Thief CHanges
Fixed a bug with Backstab that would cause the script to hide when stealth was locked even when Backstab training was disabled.
Added Khri Strike and Khri Steady.

Rearranged some items under Upkeep in Set.cmd for clarity.

5/26/19
Updated Scripts: train, library, set
Added Smite usage.  It will never attempt to feed off of your soul state and integrates with existing attack logic
Fixed a bug that caused an error with .set display all.
Changed vault usage on automapper to use 'carousel' destination to avoid issues with current map updates.

5/15/19
Updated Scripts: train, library, set
Added System Announcement alerts.
Added more prayer exclusions to SpeechAlerts.
Improved PvP Alerts and added the attacker's name to the alert.
Added Smite usage.  It will never attempt to feed off of your soul state and integrates with existing attack logic
Added Blur, Finesse, Last Gift of Vithwok IV, Membrach's Greed, Noumena, Trabe Chalice, Turmar Illumination to buff list.
Khri Plunder and Sagacity added.
Khri that are not set to YES will now be turned off if they are on.
Khri Flight, Safe, Sight, Silence, and Slight will now be turned off  when the script is running, as they are not used.
Fixed a bug that caused Barbarian variable reset not to fire.

Trader spells added to P.cmd.
PrepTimer variables added to Set.cmd under the Other section.

AutoUpkeep will now trigger earlier on script start to account for characters that begin hunting in unacceptable condition.
Premium Ring use now moves north after jumping in order to make sure the automapper figures out the room number.

3/09/19
Updated Scripts: train, library, set
Last Gift of Vithwok, Blur, Finesse added to buffs.
Fixed typo with buff display in Set.
Added PremiumRingItem variable to accomodate different types of rings.  This must be set if PremiumRing is set to YES or bad things will happen.
Fixed a bug with SpeechAlerts caused by the last update.
Excluded some janitor messaging from triggering SpeechAlerts.

03/08/19
Updated Scripts: train
Shadowling messaging prevented from spamming speech alerts when it's cast on you.
Self-speech both normally and from hiding excluded from speech alerts.

03/07/19
Updated Scripts: train
Shadowling messaging prevented from spamming speech alerts.
Added better Risen catches.

03/07/19
Updated Scripts: train, library
*IMPORTANT* Script now makes noise and alerts you if a maeldryth is in the room.
Squashed another longstanding bug with facing that could cause spammy messages when no critter is present.  This one was from casting.
"Say Ahh!" combat message properly excluded from speech alerts.

03/06/19
Updated Scripts: train, library
Long-form gweth messaging will no longer trigger speech triggers.
Added some other exclusions to speech triggers while removing the blanket "You" exclusion.  We'll see how this works out.
Tightened up hidden speech triggers, clarified output text.
Recite alert now specifies who recited.
.train alerts no longer awakens the character from sleep.
Added missing text to deepsleep function.

03/04/19
Updated Scripts: train, library, set
Script will now pause RPA's for AutoUpkeep, if an RPA was turned on manually.  It will never turn RPA's on by itself.
Osrel Meraud functions are now placed in lower priority than regular buffs.
Fixed a bug related to setting OM variables.
Theurgy training will only happen after buffing is complete.
If the script starts when the character is already bleeding it will now trigger the bleeding functions on AutoUpkeep.
Bugfix to bundle counting logic that could occasionally cause two lumpy bundles to be stored on the character.
New Variable: ManipNum - the number of monsters the script will attempt to manipulate if Manipulate is set to YES.  Either 1 or 2.
Manipulate will now only happen if there is at least 1 more monster than ManipCount in the room.
Manipulate will now only attempt to manipulate the number of creatures specified in ManipNum.


02/14/19
Updated Scripts: train, library, set
New Features
AutoUpkeep is functional!  New variables are:

=================== Upkeep ====================
AutoUpkeep: YES
PremiumRing: NO
AUTravel: YES
AUTravelDest: theren (a valid destination for the travel.cmd script included with the automapper repository)
AUReturnTravel: YES (a valid destination for the travel.cmd script included with the automapper repository)
AUReturnTraveldest: rossman
AUMOve: NO
AUMoveList: 24 (a list of valid #goto locations for the automapper, separated by the | character)
AUReturnMove: YES
AUReturnMoveList: forest|start (a list of valid #goto locations for the automapper, separated by the | character)

How it works: The script first attempts to travel using Travel.cmd, if enabled, and then uses the move option.  Note that due to the nature of travel, the route you use to get back might not be the same as you used to leave.  Additionally, for the movelists, "start" will always be set to whatever room you were hunting in, for those who don't always hunt in the same room.  

MAKE SURE TO TEST FIRST!  There is a built-in route testing function via .train upkeeptest.  It will run out, and then run back.  If this brings you back to the room you started in, everything should be good.  Note that currently it does not have any support for ferries that Travel.cmd does not cover, such as the galley between Mer'Kresh and M'Riss.  I'm working on a solution to this.  Please update Travel.cmd and your maps to the latest version using the map repositiory and let me know if you have any questions.

Properly implemented the ClimbingRopeHum variable.  When this is enabled, the script will train Performance using the appropriate settings (or not, if not enabled), and then will hum for the purposes of training with a climbing rope.  This allows a different song to be set for each for optimal learning.
Script now wakes up experience gain, just in case, on start of combat or noncombat options.

Updates and Fixes
Empath alerts now list the Empath who touched you.
Speech alerts are now limited to the first 20 characters only for what displays in the Log window.
PVP alerts updated to the new format.
Fixed a bug that caused the third DebilAssist spell to never be used.
Added calm messaging to Aim, Analyze, Fire, and Thrown Attack subs to prevent a script halt.
Added furrier location for Rossman's Landing to Upkeep.
Fixed an issue preventing the Snipe variable from being set.
Imrpvements to item handling of bundles during Upkeep.
Upkeep now stows everything in the hands at the start in order to prevent issues.

02/08/19
Updated Scripts: train, library, set
New Features
Updates to Speech Alerts.  In order to trigger off of all types of GM speech, speech alerts will now fire anytime a sentence starts, there's something, anything, and then quotes with at least one character inside them, so long as the sentence doesn't start with "You".  This is based off of recent experience with GMNPC's.  It's more likely to false positive occasionally, but I think that's worthwhile.  They will also now show you what triggered the alert, with the speech itself left out for brevity: 
[18:29] [Speech] You feel a hiss driving along the aetheric streams, and hear a voice of alternating volume that says...
[20:08] [Speech] Person says...
Name Mention is active under speech alerts.  If your name appears inside quotes anywhere in the game, it will fire.
All other speech alerts have been converted to the new standard format, and in some places made more descriptive.

Bugfixes and Improvements
Script now properly ends deep sleep when exiting AutoUpkeep.
Added missing text for Cleric dancing to prevent a script halt.
Added missing text for attacking while calmed to prevent a script halt.

2/3/19
Updated Scripts: train, library, set
New Features
Added AlmanacAlerts variable for Almanac usage in case you want to see what it's training.
Added Theurgy variable for Clerics to allow combat Theurgy training.  It looks like everything is working great.  Beware, though. as this will have you kneel, briefly, in combat.
Script now goes into Deep Sleep when entering AutoUpkeep.

Bugfixes and Improvements
Fixed a bug with DebilAssist error checking.
Fixed a bug with AutoUpkeep and App Focus when used together could sometimes cause a script halt.
Fixed a typo on Nerve alerts.
Bugfix for Almanacs being used too infrequently.
Bugfix for improper sub call with releasing a spell when casting Bless.
Fixed PFE variables.
Added an option for a third DebilAssist spell, if so desired.


1/30/18
Updated Scripts: train, library, set, p
Set Overhaul
The distinction between Buffs, Obuffs, and Mbuffs has been removed.  They are all just on the buff list.  The only .train option is buff, and the only .set option is buff - all are displayed there.  Abuffs have remained separate to preserve the utility of .train buff so as not to uselessly cast area buffs, and gbuffs remain separate as well (though will probably be revamped in the future).  Before updating, print out .set display buffall if you need the data there, and make sure to add all of your buffs to the Buffs list.
Research display option under Set.cmd merged into the Spell option.
Weapon and Armor display option under Set.cmd merged into the Combat option.
Survival and Lore display option under Set.cmd merged into the NonCombat option.
Help and options display for Set.cmd merged.
Added OTHER option to Set.  Basically, these are variables for other scripts such as P.cmd and the not-yet-released kill.cmd (which I'm working on in the background as a lower priority than the main script updates I'm doing right now).  Added to this list are custom settings for the P script.  PCambrinth, PChargeMax, PHarnessing, PHarnessMax.

New Features
AutoUpkeep is now active!!!  The AutoUpkeep variables are in the Upkeep section.  AUOnHealth and AUOnBleed are the two parameters on which basis it will go into AutoUpkeep.  Currently only PremiumRing travel is active.  The other parts are basically functional, but not active yet as I'm still running tests to work out the kinks.

Khri Harrier and Khri Endure have been added.
Dragon, Eagle, Owl, Panther, and Wolverine forms have been added.
Barbarians and Thieves will now use their abilities with the ".train buff" option.
Rangers and Thieves now have a Snipe variable.  If set, sniping will be used when appropriate in existing training.
New Variable called PostBuffPerc.  If set to yes, after casting a buff spell it will do a perc to reset your spell variables.  This is to avoid the issue of double-casting that may happen to some people (and appears to be based on lag).
Added Redeemer's Pride and Lay Ward to the possible Buffs list.
Added ClimbingRope and ClimbingRopeName variables for the use of a climbing rope.  Currently only supports unlimited use climbing ropes.

Bugfixes and Improvements
Fix for prepping BTN using P.cmd.
Fixes to instrument drying for instruments that are plural (zills).
Get functions now can stop playing a worn instrument if they need to.
Cleaned up scrolling text in Textbook Logic and redundant stow command.
Adjusted matches for cambrinth items to prevent accidental stowing instead of proper wearing.
Thief and Barbarian Spelltimer variables reset at script start just as spellcasting variables already are in order to avoid a bug in Genie.
Adjusted health alerts to me more explanatory and to new standard.
Adjusted Bugout messaging to new standard.
Condensed Upkeep messaging into one sentence that incorporates data from every upkeep action that is enabled.
Added Upkeep output for autopath usage.
Any spell and mana are automatically released upon Upkeep start to prevent issues with App Focus.

01/08/18
Updated Scripts: train, library, set, p

New Features
Alerts now output to the window specified via the AlertWindow variable.  The default still routes them to the main window, but the Conversation and Log windows are now an option.
Added tattoo usage.  They live under the BUFF heading.  Variables are TattooBuff to decide if it's used, TattooSpell, for the spell name, and TattooAddMana for how much mana to add to the spell.
The CYCLIC option in Train is renamed NORT, for No-RT training with minimal room spamming, primarily for training while moving.  It now no longer forces cyclics to be active (so it only uses them if you normally have them active) and will use sanowret crystals if you have the NonComSanowret variable set to YES.
The various BUFF options in Train now respect whatever variables you have set for casting under normal circumstances, with the exception that it will never choose to prep at max even if StraightCast is enabled, and will never prioritize harnessing over cambrinth even if Arcana is locked.
Added Barbarian abilities to be checked during the status check that follows every action.

Bugfixes
Implemented some logic to prevent SpeechAlerts from triggering off of the communication window as well as the main window, resulting in two different alerts firing for each bit of text.  This now means Speech can only trigger once every second, but I can't imagine this will be an issue for anyone.
Cleaned up regex for SEND to no longer trigger alerts through normal ESP use.  Confirmed that triggers are still working with known GM SEND text.
Fixed a bug preventing locksmithing training boxes from being used properly.
Fixed a bug preventing PFE and SOS from being set as MBuffs in Set.
Significant work refining cyclic and ritual matching.
Rewrote spell variable matching to enable tattoos, make it simpler to add spells, and greatly streamline that area of code.
Performed under the hood changes to allow ritual spells to have mana added to them so that ritual tattoos would work properly.
Added missing messaging to avoid a script halt if you attempted to dance on a prayer mat while too injured.


12/23/18
Updated Scripts: train, library, set

Cleric Updates
Added Divine Radiance as a possible Buff or OBuff.
Added Protection From Evil as a possible MBuff.
When set as a DebilAssist spell, Divine Radiance will be used as a targeted spell.
Added alternative pantheon messaging for Pray.
Better error checking on Osrel Meraud variables added.
Fixed an error in the OM display in Set.
Removed OMTimer variable and keyed Osrel Meraud to be recast based on duration.
Added capability for the script to add and maintain a set of spells to OM.  New variables: OMBuffnum and OMBuff1-8.  These will be prioritized most highly among the buffs.
HYHCast variable added to allow choice in how Hydra Hex is cast.  Options are coz or male.

Other Updates
Options for displaying/using all buffs tweaked in both Train and Set.  New name for both options is BUFFALL.
BUFFALL will now run through all buff types you have enabled, but not the ones you don't.
Added this spell prep: With great force, you slap your hands together before you and slowly pull them apart, focusing your mind to the task of preparing the Refresh spell.
Upkeep should now no longer attempt to use shops in Fang Cove at dusk when they are closed.


12/14/18
Updated Scripts: library, set, p
Further bugfixes to ritual spell matching to prevent OM from accidentally matching POM.

12/13/18
Updated Scripts: train, library, set, p
Fixed a bug related to polearm slice combo and a script crash.
Fixed a bug that caused Empath health checking to happen way more than it should if Heal was enabled.
Added variables for Vitality Healing.  VitHeal, VitHealPrepMana, and VitHealAddMana do the usual.  VitHealNum is the health threshold that it will cast at.
Praying with a prayer mat now uses the appropriate variable for unrolling.
Cleric Devotion rituals now have a variable for BlessDelay variable to decide how many seconds to wait before snap-casting bless.  Default is 2 seconds.
Added Almanac variable for almanac use in and out of combat.
Windboard use has been added to NonCombat functions in addition to to combat.
Locksmithing Box use has been adeded to NonCombat via LocksmithBox variable.
Locksmithing Box use has been adeded to Combat via CombatLocksmithBox variable.

Upkeep Related:
NonPremHeal procedures now check for your health status to save time.  If you have the "You have no significant injuries." message in your health text it will not attempt to get you healed.
Autopath goto fixed for Riverhaven healer.
Upkeep now will have specific rooms it chooses to end in to aid in properly scripting returning to combat.  For multi-map areas it has a specific map it will return to.
Repair is now moved to after bundle selling and coin handling in the script in order to ensure enough money is available for repairs.  MinMoney is now checked again after repairs as well.
Yet more serious upgrades to Move function to make it more fault tolerant.
Systematic changes to allow Upkeep functions to be called in other ways except at script start.

P related:
AP, WM, MM, Necro, Bard, Empath, Cleric spells all fully implemented.  Ranger, Paladin, Trader spells to come soon.
Rewrote the way spells are matched to their spell type, and fully calaloged all spells from the above guilds.  This should be mostly invisible, and I think I've gotten the bugs worked out, but if you run into any issues, especially with it trying to cast a spell as a ritual when it's not or something, let me know.

11/14/18
Updated Scripts: train, library, set
Khri Elusion added.
Added variables for shield noun and description.
Added variables for Smite.
MOVE function made more robust.
Numerous small changes to make item handling more robust and to lead into making automated upkeep possible.

Added zsew.cmd, a Zasele sewing task script.


10/21/18
Updated Scripts: train, library, set
Bugfixes and logic simplification to weapon hand choosing.
Fixed Khri Kneeling.
Added Khri Debilitation training via KhriDebil and KhriDebilType variables.  Should work with all debilitation khri, but I was only able to test with Prowess.
Added logic to rehide if pointed out of hiding just before performing a backstab.
Bugfix to library to prevent an issue with an invalid match when harnessing during Astral.cmd or P.cmd

10/05/18
Updated scripts: train, library, set
Isolated and fixed a longstanding bug that would intermittently cause a script crash with an infinite loop when using textbooks, along with other logic errors.
Adjusted messaging traps for sanowret gazing.
Adjusted weapon attack routines to make better choices on which maneuvers to use, and fixed a slice maneuver accidentally set for piercing weapons in some cases.
CureDisease, CureDiseasePrepMana, and CureDiseaseAddmana are now active.  Detected diseases will be cured.  This is placed in higher priority than Heal casting.
Heal now no longer pre-empts other spells being cast in order to prevent various issues.  Heal is also placed below maintaining buffs in priority.  This should be fine as the script should keep you generally healthy and should prevent accidental downward spirals.
Khri that requires you to kneel due to lack of skill will kneel and then stand back up.

10/04/18
Updated scripts: train, library
Backstab will still train with the appropriate weapons if set, even if Stealth training is not turned on.
Changes to ensure that Harvest won't fire after Consume has been used and Devour cast.
Messaging added to Harvest just in case it fires anyway to prevent a script halt.
Heal will be allowed to fire when the character is bleeding, even if the timer hasn't come up yet.

10/03/18
Updated scripts: train, library
Several more bugfixes to Devour.

10/03/18
Updated scripts: train, library
Bugfixes to Devour.

10/02/18
Updated scripts: train, library, set
Bugfixes for finding autopath in Lang/Theren during Upkeep.
Bugfix for bundle selling on Fang Cove.
New Variable: HarvestStoreNum.  Harvest will discard material once the material count in storage is at this number
Heal, HealPrepMana, and HealAddMana variables are active for Empaths.  When Heal is set to YES, health will be checked every 2 minutes.  If you have injuries bad enough to no longer see the "You have no significant injuries." message, Heal will be cast.  This is done to preserve mana.  As time goes by, I plan to add more granular control, but I want to make sure it's working first.
Devour, DevourPrepMana, and DevourAddMana are active for Necromancers.  When a creature is killed, if you have injuries bad enough to no longer see the "You have no significant injuries." message, the appropriate ritual will be used and Devour will be cast.

To both of these, **please** keep an eye on them and let me know if you run into any strange issues.

Thief-Related
Script will now correctly identify when Absolution is up and if it's ok to attack undead creatures.
New variable: LootType.  This decides how you loot monsters.  By default, this is assigned to "treasure", which is how the script has awlays run int he past.
Sniping will now no longer be attempted if the character is not high enough circle - it will poach instead.
SECombo variable is added, to support puncture SE weapons.
Bugfixes to backstabbing.
Backstabbing now will force the use of stealth if it's not locked when using a backstabbing weapon.
Tactics will take a lower priority than locking Backstabbing if using a backstabbing wepaon.
Backstabbing now allows SB weapons instead of just SE weapons.
KhriFocus, KhriDarken, and KhriDampen, KhriAvoidance, and KhriHasten variables are active and skills are usable.


9/28/18
Updated scripts: train, library, set, p
Several structural updates to enable use of the Kill script - which is replacing the pvp script, but not yet released.
Refinements made to the NecroWhitelist logic.
Bugfixes to researching.
Absolution name in the script is changed to "abs" to be in line with the official abbreviation.
Absolution now perc's after cast to avoid doublecasting issues.
Added failure messaging for Perceive Health.
Sanowret crystal triggers adjusted to account for different crystal messages.
Risen locate alerts added.
Bugfixes to P.cmd.
Devour spell, when used via P, now will now either attempt to use a dead body by performing the consume ritual, or get some material for casting.  If it can't find either it aborts.

8/26/18
Updated scripts: train, library, set, p
New variable - SanowretItem.  Please set this variable to the appropriate text if you plan on using sanowret crystals.
Cambrinth removal functions (for low level characters) have been updated to work with multiple cambrinth items and now go through standardized item removal logic to avoid errors.
Bugfix to p.cmd that caused a freeze.
Bugfix for Barbarian form stopping function.
Removed listening variable from Set.cmd.  It is not currently used.
Bugfix to stop teaching and researching from happening during buffing routines.
Cleanup of STATUSCHECK calls at script launch to prevent some issues with spellcasting sometimes happening before the first perc, which sets magic variables.
Necromancers now have the NecroWhitelist variable.  Make sure to capitalize names properly and separate by pipes.  This exempts certain characters from the NecroSafety checks to allow group hunting.  The player list handling code here is a precursor to numerous things I have planned, among them code to wait in line for healing.
NonPremHeal is working, but still undergoing testing and refinements.  It does not wait in line yet, and it does not check yet if you need healing.  I wasn't happy with the logic for that yet.  Please test and let me know if there are problems.

8/16/18
Updated scripts: train, library
Some adjustments made to how spell variable are reset in order to be more fault tolerant.
The "There is nothing else to face!" message when attacking has been modified to just end the attacking in order to prevent spammy loops of facing over and over again.
Bugfixes to NecroSafety. 
Wind Hound category placement adjusted to avoid unintended empathic shock.

8/14/18
Updated scripts: train, library, set, astral
Fixed a bug with MinConcentration.
Necromancers now have the RiteOfGrace, ROGPrepMana, and ROGCycle variables under the Guild section.  If enabled while NecroSafety is enabled, the script will explicitly cast ROG before casting any other buff spells.  If ROGCycle is set to YES then the script will take the risk of releasing and recasting every 5 minutes in order to maintain cyclic learning.
Research is now live.  It will be performed under the QUIET setting using .train, which is primarily for roleplaying situations.  There is a Research heading under Set.cmd for all the variables.
Variable is in place for Non-Premium Healing.  It is not ready yet, though, so do not enable.
Fixed a bug in astral.cmd.

8/4/18
Updated scripts: train, library, set
CombatSanowret is live.  This trains Arcana using sanowret crystals in combat.  This may or may not be a good idea for spellcasters.  I'll be testing it.
Added "my" to SELLITEM function to avoid issues with duplicate items being on the ground.
Added stowing logic to several textbook use outcomes to prevent some issues with skinning.
Bugfixes to ArrangeForPart logic.
Bugfixes to AppraiseLumpyBundle logic.
Some bugfixes to bundle processing.
Updated Set.cmd help.  Cleaned up Magic section, as it was getting unwieldy.  Removed variables displayed in two different places, such as buff variables.
Set has a new section - Research.  Research itself is still under testing and not ready for release yet.  Look for it in the next update.

7/29/18
Updated scripts: train, library, set
MinConcentration is live.  This allows you to set the minimum Concentration the script will require in order to cast spells.  The former hardcoded value for this was 80, which is now the default value.
Auspice added to Obuff list.
Typo fix to speech alerts.
Train.cmd help reorganized and cleaned up.
Cleaned up Non-Combat code and standardized status checks.
NonComSanowret is live for non-combat sanowret crystal use.

7/26/18
Updated scripts: train, library, set
Changed the order of some commands with bundle tightening to ensure the correct bundle was tightened.
Moved Misdirection to the Magic section for non-bards (still invisible for NMU's).
Added error correction to Misdirection variables.

7/24/18
Updated scripts: train, library, set, astral
LowestFirst variable is now live.  If set to YES the script will re-sort your weapon list so that they are trained in order of least ranks to greatest ranks.  This works in EvenTrain or normal training modes.
Infected wounds now have an alarm.
Fixed messaging for removing cambrinth items to charge them.
Work done under the hood on skinning code organization to enable expansions.  Nothing should functionally change.
ArrangeForPart is live.  If set to YES, you will arrange for parts rather than skins.  This allows for lighter bundles on certain creatures such as storm bulls.  Note that this will only be relevant if Arrange is set to at least 1.
TightBundles is live.  If set to YES, you will bundle into tight bundles instead of lumpy bundles.
SaveLumpyBundle is live.  If set to YES it will automatically set TightBundles to YES and will attempt to save a full lumpy bundle worn on your person for the purposes of Appraisal training.  All other bundles will be tight - this is needed so as not to go over the item count limit.
If a bundle cannot be worn the script will now attempt pull the bundle to find another spot to wear it.

LumpyBundleSave variable is live.  If set, the script will save one lumpy bundle for appraisal purposes.  This affects both bundle handling and upkeep.  Note that the code for the script to appraise these lumpy bundles is not yet live.
OutdoorTimer, TextbookTimer, and CompendiumTimer automatically forced to 0 for NonCombat training.  There's no good reason not to have them this way.

Moon Mage Astral Travel variables have been added to the guild portion of Set.cmd.
Typo fix in Astral.cmd.

7/7/18
Updated scripts: library, astral
Skinning is now prioritized over Thanatology for Necromancers due to how much easier Skinning is to lock.

Astral travel script has been seriously reworked.  Several features (extra safety, double pow, reharnessing) were either working improperly or not working at all.  Power perception, spellcasting, and movement now all use standard subs and are much more fault tolerant.  Introductory checks reworked.  
Removed the "force 100" option from Astral.  Script now decides whether to use the shard based on how AstralSafe is set.

7/4/18
Updated scripts: train, library, set
Resolved an issue that caused armor to be checked after every weapon use when using thrown weapons when ArmorSwap is enabled.
CollectItem can now only be set to "rock" or "bunny".
Fixed a bug where when objects other than rocks that were collected they would not be kicked away.  Will now kick away and piles of rocks or dust bunnies.
Put in a fix for Expertise getting stuck when switching weapons away from a maneuver to brawling.  This is difficult to text for.  The likeliest error to come from it is Expertise stopping training and never starting again.  Please let me know if you run into any issues.


6/27/18
Updated scripts: train, library, set
Bugfix to riste use.
Variables added for LowestFirst weapon training.  Not active yet.

6/25/18
Updated scripts: library
Quick update with messaging for faeweave baldrics.

6/25/18
Updated scripts: library, train
When EvenTrain is off aimed weapons now increment the attack count by 2 to compensate for how much longer each shot takes and how much more experience you get.
Armorswap will now classify all thrown weapon use as non-stealth, and armor up appropriately.
Fixed a bug with Ignite caused by a typo.
Some changes made to the attack logic, prioritizing checks and limiting gosubs in order to hopefully solve the infinite loop issue.


6/24/18
Updated scripts: train, library, set
Armorswap has been completely rewritten from the ground up.  It is now vastly more reliable, no longer gets confused, will now wear your armor if the script starts and you weren't wearing it, and can check to make sure you're wearing the armor it thinks you're wearing with a simple "inv armor".  You MUST update the new armor variables before running the new armorswap.
  armornum - How many pieces of armor you're wearing.  Max of 4.  I'll probably add options for more.  Let me know if that's urgent for anyone.
  armor1name - The text you want the game to use to manipulate the armor.  "hauberk" or "quilted hauberk"
  armor1desc - The exact text that displays when you type "inv armor".
  a1stealthrem - If you want the armor to be removed when you're stealthing.
The NVStealth (Nonviolent Stealth) variable is no longer used.  Instead, the script looks for AvoidShock and Stealth to be set and the right circumstances.
Bugfix to collectitem not using the variable name properly and still collecting only rocks.
Systematic changes to no longer use the !def script command due to flakiness.  I'm just not happy with how it was working out.  This should be invisible.
Prereni added to the skinnable critter list.

Barbarian warding training can now be set to use Swan form.  More to come here as I test the code.
Barbarian forms Bear, Buffalo, Monkey, Piranha, and Python now have variables to be set to use them defensively.  Planning to add Panther, Dragon, and Eagle soon, as well as management of how many forms you have running, but these are trickier and will take a little more time.
Added missing messaging for Necro Harvesting.
Added missing messaging for ammo collection.



6/13/18
Updated scripts: train, library, set
CollectItem is now a variable available to change what you want to collect.  Useful for specifying dust bunnies when you hunt indoors.
Fixed a bug in NonComDelay logic.  It was allowing the retreating skills to be trained at lower weapon mindstates than it should have.
Adjusted riste matching.  Now, it will match the item as a half-handled riste ONLY IF the item name is "half-handled riste" in the variable.  If not, it will decide it's a regular riste.  Tested this behavior pretty thoroughly and it seems to be working properly.
Updated some Empath spellcasting messaging.
Added a delay for subsequent form activation to compensate for the lag time forms have before they hit the SpellWindow variables.


6/12/18
Updated scripts: train, library, set
Support for using both riste types at the same time is now in.  Please use either "riste" or "half-handled riste" as your weapon name variable in order to get them to register properly.
The non-EvenTrain option in combat has now been made relevant.  Setting EvenTrain to off will run a weapon until either the single weapon locks, or until it hits the number of swings in the MaxSwings variable.  It will then move on to the next weapon, continuing down the list until it hits the end, at which point it starts over.  If MaxSwings is set to 0, it will just go until each weapon is locked.  The reason you would do this is if you want to train more weapons than you can effectively keep going at one time using EvenTrain, but want to ensure that you are still spending roughly equal time on each one.
The WeaponMin variable is no longer used and all references have been removed.
MonkeyForm has been added as an option for Barbarians.  If this is turned on, it will try to keep Monkey Form on at all times.  If turned off, it will ensure Monkey Form is off, even if it was on at script start.  More of these variables will be forthcoming over time.
Some bugfixes to how Barbarian abilities are processed.



6/8/18
Updated scripts: train, library, set
Added logic to prevent a script fault on an edge case when throwing a HT weapon left-handed when both hands are full.
Logic for the "You feel intense strain" messaging has been removed from casting.  It was causing more problems than it solved, and this issue is adequately solved by the MinMana variable.  If you find you don't have enough mana to cast your spells, just up the MinMana variable until your attunement grows.
Bastard Sword swapping has been reverted to no longer use triggers.  Weapon handling function has been rewritten to compensate.  Hopefully this should resolve the bastard sword issues.
Roars will no longer attempt to fire unless a critter is in the room.
RoarRage has been changed to an appropriate set of debilitation training variables.
Error correction has been added to Set for Barbarian variables.
Code for ArmorSwap has been streamlined.


6/6/18
Updated scripts: train
Bugfix to bastard sword triggers.

6/5/18
Updated scripts: train, library
Fixed the bastard sword swapping issue, hopefully for good this time.

6/4/18
Updated scripts: train, library, set
SpeechAlerts have been completely rewritten.  It should now be nearly impossible to miss someone or something attempting to communicate with you.
ESP now uses a different sound.  Please download the ThinkTo sound in the sounds folder and put in your Genie\Sounds folder.
Added some missing bastard sword swap messaging.
Added some Barb-related training variables.  Currently, the only thing it works with is berserks, and the only berserks it works with are Avalanche and Famine.  I'll be adding more functionality in the future.

AugmentTrain: YES
AugmentTrainType: berserk
AugmentTrainName: Avalanche
WardingTrain: YES
WardingTrainType: berserk
WardingTrainName: Famine

Bugfixes to Expertise issue when continuing a combo.

6/2/18
Updated scripts: train, library, set
Added swapping ristes as an option.  No need to specify which type.  The script should figure it out.  The riste needs to be referred to as "riste" or "half-handled riste" in the variable.
Added swapping war icons as an option.  The icon needs to be referred to as "icon" or "war icon" in the variable.
Rewrote weapon swapping code to be much more efficient and better at figuring out what's being used, as well as to make it easier to add other swappable weapons.
Fixed a longstanding bug where the script could sometimes make a few swings with a swappable weapon at the wrong setting before fixing it.
Added several Barbarian variables:
Warhorn will blow the WarhornItem as a lure to increase creature spawn in the room once every 4 minutes.
BerserkAva decides if Avalanche is to be used.  AvaFatigue makes it only turn on if Fatigue is lower than that amount.  Put this number at > 100 if you want it on all the time.
BerserkFamine decides if Famine is to be used.  FamineVit makes it only turn on if Vitality is lower than that amount.  Put this number at > 100 if you want it on all the time.
Barbarians and Thieves no longer see some unnecessary magic stuff in Set.


6/1/18
Updated scripts: train, library, set, p, pvp, gags.cfg
Barbarians and Thieves no longer will attempt to perc or release spells at script start.
Barbarians now have the option to train Expertise via combos using the Expertise variable.
Underlying Tacitcs code has been polished.
NonComDelay is a new option that will delay training any skills that require retreating (such as Appraisal or Outdoorsmanship) until after all weapons have 10 mindates.  Only functions when using EvenTrain.
Removed more unnecessary messaging in Train.
Bugfixes to casting chain lightning.

Bugfixes to P.
PvP made significantly more robust.
Lots of gags added related to storm bulls, bard stuff, and other more universal stuff.

4/08/18
Updated scripts: train, library, set
SaveGwethStones now only collects jadeite or kyanite stones.  The others are irrelevant after the gweth changes.
A new variable, called CollectScroll is now available, and enabled by default.  It will collect and stow dropped scrolls from critters.

4/05/18
Updated scripts: train, library, set, astral, p, sgags, pvp
Added DebugMessages variable.  This defaults to NO.  If enabled, it will display all the various status messages of the script.  If disabled, it will not display any of them for more compact running.
Removed some messaging that was not useful or necessary.
Updated some text used in Upkeep weapon repair.  Either they changed something, or I just ran into a weird situation I hadn't seen before.  Regardless, it's fixed.
Some updates to variable storage in Astral.cmd.
Updates adding some Bard spells to p.cmd.

Sgags (script gags) script is in the bunch.  It disables most messaging from the game window, at least what I've been able to collect from using Saragos.  If you have messaging you want gagged, please send me anything that gets through.  I will continue updating the gags file.  Eventually, I'll have it auto-setup, but for now definitely consider it beta type software.  For certain, any critter messaging other than armadillos will need to be collected and gagged if you want it hidden, as well as non-WM spells.  I'll be working on the rest, though.  I've striven to make the regex as narrow as possible for this so as not to accidentally gag anything that might be useful to see.

Setup:
 * Copy the gags.cfg file into Genie/config/  It will need to replace the existing gags file.  Eventually, when I'm confident enough, I'll have an option to just add it to your file.  For now, you'll just have to do it manually.
 * Add this trigger to your triggers file: #trigger {e/$scriptlist/} {#if {!contains("$scriptlist", "sgags.cmd")} "#class sgags off"}
 * Because of how genie works, by default, these gags will all start enabled.  Be aware!
 * Run this text in-game: #class sgags off  
 * Run this text in-game: #class save
 * Run the sgags script when you want things hidden.  If the script is not running, nothing will be hidden.  If it is, things will be hidden.

I've also included my WM pvp script for reference, if anyone's interested.  I'll be adding some more stuff to it and making it more robust and automated, as well as variables that plug into it so that maybe it will be useful to everyone who wants to use it.  Feel free to ask me if you have any questions.

2/28/18
Updated scripts: train, library
Bonds should only be invoked on thrown weapons when LTBond or HTBond is set to avoid using up limited bonds.
Young wyeverns added to the critter list.

2/24/18
Updated scripts: train, library, set
Ease Burden added as a buff.
During bugouts, if LtBond and HTBond are both enabled, it will invoke bond twice, just in case.
More Bard casting messaging added.
DebilAssist is now active.  If a weapon is on a list separated by bars such as, ht|pole in the DBAList variable, the script will cast one of two possible debilitation spells.  If both are selected, it will rotate back and forth.  Otherwise, it will just cast the one selected.  For the duration of that weapon being trained, it will use debilitation to assist in training.
Added messaging to prevent a hang when you attempt to tend a wound while performing.

Numerous bugfixes to Upkeep.
Upkeep reporting improved and made more reliable and accurate.
Bundle rope acquisition finally implemented via the BundleRope variable.
Upkeep will now wait for the App Focus to complete before making sounds and outputting the upkeep messaging.

2/17/18
Updated scripts: train, library, set
Fixed a bug with Misdirection and some other spell tracking logic which could happen if you've never cast the specified spell before.
Added ltoffhand and htoffhand variables for using thrown in the offhand.  These work the same as the other offhand variables.
Added logic to swap hands if the thrown weapon somehow lands in the wrong hand.
BundleVault should now confirm you have a tight bundle to vault before going to the vault.
A new variable BuffBuffer has been added.  This is the number of minutes the script will allow to be remaining on a spell before renewing it.  Defaults to 2, which is what the previous behavior was.  If you are having trouble keeping your buffs up due to mana, you can set this one higher.

2/11/18
Updated scripts: train, library, set, p, preptimer
App Focus has been added to upkeep.  If AppFocus is set to YES, it will attempt to use it at the end of the upkeep routine.
Revamped all other instances of App Focus in the script.  It is now only available through ".train focus" or ".train upkeep".
Upkeep will now return you to the room you started upkeep from at the end.
Script will now check to see if you have any bundles to sell before running off to sell bundles during upkeep.
Updates to some old checks to ensure that they properly handle webbed status.
Bugfixes to bugs in bundle vaulting, which were in turn caused by fixing bugs to bundle selling.
Bugfixes to vault summoning.
Removed some unneeded comments from Upkeep.
Guild-specific checks for Misdirection have been removed.  If you set the variable, you should be able to cast it.

There is a new section for Upkeep in Set.  Existing upkeep variables have been moved there.  AppFocus has been moved there.
Misdirection-related variables are now visible to all guilds under the guild heading in Set.

Some minor updates to P in preparation for adding the rest of Paladin, Bard, and Trader spells.  Rage of the Clans and Drums of the Snake added.

Removed some unnecessary echoes to the game window from PrepTimer

2/06/18
Updated scripts: train, library, set
Fixed a typo that could cause weapon bonds not to be invoked during bugout.
Bugout should no longer be possible to occur during upkeep.
Raven's Point added as a possible upkeep location, for the services it offers.
A full pass has been done on all supported upkeep locations to make sure all upkeep options work.  The only places not currently tested are Aesry and Muspar'i.  I'll get to those.  Let me know if you run into any problems anywhere.

2/05/18
Updated scripts: train, libary, set
Added Exchange option to exchange non-plat coins to your current currency and deposit them.
Various unnecessary actions (such as spellcasting) will no longer occur while bugging out.
Added script support for a specific failure to pull an arrow/bolt from a creature.

1/31/18
Updated scripts: train, libary
Bugfixes to new disposal logic.  Braiding should now be fixed.
Fixed a bug in bundle selling (hopefully), which caused stowed tight bundles not to be properly sold.

1/28/18
Updated scripts: train, libary, set, astral
ArrivalAlerts is a new variable that will make noise if someone enters your room.
Tap alert now only fires if someone taps you.

Added a DedicatedCambrinth variable.  If enabled, script will use dedicated cambrinth for spellcasting.
Added an InstrumentHands variable.  This is necessary to prevent two-handed instruments from attempting to do tasks that can't be done while playing.  Defaults to 2.

Made item getting for repair more robust by running it through standard weapon acquisition logic from the combat portion.
Sack dropping now runs through new standard item disposal logic.  It will drop in a bucket or similar opject if one is available.
Upkeep now makes a sound when complete.
Added bundle selling to Upkeep via the BundleSell variable.  Currently tested to work in Theren, Lang, Haven, Crossing, Wolf Clan, Fang Cove, Mer'Kresh, Leth, Ratha, Shard.S
Script will now look at clockwork spiders once per hour.  If a trigger is set up, then this will cause it to be fed.
BundleVault, VaultMove, and MinMoney variables now show up in Set.  These are not yet active, but will be soon.

Cleric devotion routine is now added to the script via ".train devotion".
NecroSafety is now significantly better at detecting players in the room and making sure to stop all casting activity.
Added Misdirection variables for Bards.  Stealth will now waitbfor this to be cast if enabled.

Important bugfix to Astral!  Please update to prevent a potential death when going to certain locations.

1/19/18
Updated scripts: train, library, set, p, preptimer
Added premium healing via the PremiumHeal variable.  This will only activate while in Fang Cove, and will not trigger healing at any other locations.
Removed alarm sound for "you are still stunned".  It was redundant and noisy.
Bugout will now not be able to be interrupted by the bugout triggers and attempt to bugout in the middle of a bugout attempt.
Added missing text to bugout functions.
Health alerts will now only trigger when health goes down, as opposed to health having any change at all - really pleased I figured out how to do this!  Much less noisy now.
Artificer's Eye added as a buff.
Cleric buffs should now be complete - Auspice, Glythtide's Gift, Persistence of Mana added as buffs, Soul Shield added as a magic buff, Ghost Shroud, Hydra Hex, Soul Attrition added as cyclics.
Confirmed completeness of buffs and cyclics for Clerics, Moon Mages, Necromancers, and Warrior Mages.  Other guilds are still in progress.

All Cleric spells added to P.

Aspects of the All-God added to PrepTimer.

1/14/18
Updated scripts: train, p, preptimer, astral
Shard and Hib are now supported for gear repair.

All mana settings on P are now routed through central logic.  This should largely be invisible.
In P, TM spells can now have a target specified, or can use area/creature/etc.
In P, all existing AP, MM, Necro, and WM spells now go through central logic, making it easier to update and bugfix, as well as adding a great deal of flexibility to casting.  You can now specify a mana value, a target, both, or neither, and the script will figure it out.  Example: .p ip 33 saragos, .p ip 33, .p ip saragos, and .p ip - are all functional.
Functions spells with specialty logic (moongate, locate, riftal summons, gateto, teleport, moonblade, cage of light) have been rewritten.

Preptimer has been updated to better auto-detect when the extra roundtime for hidden casting is appropriate.
Preptimer how has a "preptimer setup" option to automatically setup the trigger needed.
Saesordian Compass added to Preptimer.

Turned off some alarms for astral travel, pending further work.  They should really compensate on their own rather than making nosie at you.

1/9/18
Updated scripts: train, library
Removed the statuscheck after hiding but before swinging a weapon.  This was causing other actions, such as spellcasting, to occur between the hide and the ambush attempt.  This removes a small margin of safety, but on balance I think it's better, as the script will check for those things after the attack is carried off.
Item repair has now been updated and tested to work in Riverhaven, Therenborough, and Langenfirth.  Confirmed not to work in Rossman's and Leth, due to lack of repair facilities.
Bugfix to item repair to not always think it was on Fang Cove and decline to repair things at night.
Several missing messages trapped for in item repair.

1/8/18
Updated scripts: train, library, p
Fixed a missing bracket that was causing p.cmd to fail to run.  Oops.
Removed hiding from thrown weapon use.  You don't get the extra experience for ambushing, and I don't think the roundtime is worth it.
Minor messaging additions to item handling subs.


1/7/18
Updated scripts: train, library
Armors are no longer detected at script start for ArmorSwap if Stealth is not enabled.
Fixed a bug with bugout stance changing that could cause a script halt.
Fixed an issue where attempting to use the Harvest ritual with both hands full could cause a script halt.
Fixed some incorrect text when doing .train upkeep.

1/6/18
Updated scripts: train, library, set, p, preptimer
Added UPKEEP option to main training script, and variables Repair and RepairList.  RepairList is the weapons to be repaired separated by "|".  When in any town it will move to the repair locations and automatically repair, recover, and wear/store the items.  More options to come here.  This has currently been tested in Crossing, Fang Cove, Mer'Kresh, and Ratha.  It may or may not work in other places.  Probably won't work in Shard.  I will be adding all the major cities as I get time.
Changes to some item handling functions in Library.cmd to support item repair.  Should be invisible, but let me know if anything seems weird.
Added better trapping for the minmana variable.  It was sometimes not stopping spellcasting.
Bugout functions will now place the character in a fully defensive stance (100 evasion, 100 shield, 0 offense) before attempting to do any of the other things involved in bugout.
Fixed a bug introduced into a recent version due to my testing that caused some alerts not to fire.

If NecroSafety is set to YES, cyclics will no longer be released at script start in order to prevent releasing Rite of Grace.
Necro TM and debil spells now function on P.cmd.
Necro spells now default to max mana if no mana is specified in P.cmd.
Aethrolysis added to P.cmd and PrepTimer.cmd.
WM TM spells now function on P.cmd.
WM spells now default to max mana if no mana is specified in P.cmd.

12/14/17
Updated scripts: train, library, set
Added support for up to 7 spaces in the TextbookList variable.
Some code for assigning weapons in set.cmd was rewritten to eliminate input issues.
Added some error correcting code for weapons variables.
Added support for ritual foci and tm foci to be worn.  If this variable is set it will preempt having a specific storage location set for them and flip the respective variables to NO.
Adjusted some priorities in which order things are checked for status checks (ready to fire, ready to cast, bleeding, not prone, etc).

Added NVStealth (non-violent stealth) option for stealth that does not use attacks.  Most likely only useful for Empaths.  This fixed a bug where the existing NVStealth code was sometimes being triggered when it should not have been.
Bugfix for Acid Splash casting sometimes not registering a cast properly.
Throttled EOTB releasing code for Necromancers to prevent some spamming issues.
Added variables for some Cleric-related things; code not yet active.


12/13/17
Updated scripts: train, library, set, astral
Added support for TM foci.  Tested it out, but I won't be training with it for the time being, so please test to make sure it's not stowing it when it shouldn't be, causing you to eat the invoke roundtime.
TMDBPrior will automatically be set to YES if TMFocus is enabled.  This is checked for every time at script launch, so it won't be able to be overridden, not that it would ever be a good idea to do so.
Weapon use is disabled when TM Foci are currently being used.  I can't imagine a case where you'd ever want to eat that focus roundtime with every use.
Fixed a bug with TM and Ritual foci causing them not to be placed in their proper storage container even if the proper variables for that were set.
Updated astral.cmd.  It was a bad copy that I somehow uploaded.

12/2/17
Updated scripts: train, library, set
Added RapidCast option.  If set to YES, this will cast spells as fast as is possible to cast rather than once every loop through the script.  Use with caution.   Defaults to NO.  Only enabled for combat casting, due to it not being necessary out of combat.
Added MinMana option.  The script will not attempt to cast spells if your mana is less than the minmana number.  Defaults to 0, so this will have no effect unless you set it higher.
Added a check to remove Sancutary if it's ever on in combat training.
Throttled how fast Rising Mists code checks the room to see if it needs to recast.
NecroSafety option will now engage in no spellcasting activity whatsoever if another player is in the room.  Later, I will add an option for a whitelist.
Script will non longer activate speech alerts or health alerts for the various buffing options.
Fixed a script halt for unloading a bow while invisible.
Fixed a script halt for a particular critter not found message when casting.
Adjusted cast target messaging for TM spells to just "cast" instead of "cast creature".  Let me know if this causes any issues.
Ritual foci can now be stored in RitualFocusContainer if RitualFocusStorage is set to YES.
Variables are in place for TM foci, but code is still being worked on.

10-9-17
Updated scripts: train, library, astral
Fixed several errors with cyclic logic, focused primarily on multiple cyclic use.
Fixed some bugs with instrument playing and spellcasting.
Fixed a bug causing Blessing of the Fae not to be properly detected.

Fixed a bug that could cause astral.cmd to crash in some instances when you got the "walking around in circles" messaging.
Fixed a logic error causing re-harnessing to never actually happen.  Had some trouble getting a good test for this, since I couldn't get to a point where my MM needed it, so keep your eyes open.

10-1-17
Updated scripts: train, library
Prep messaging added for Aether Wolves.
Wound diagnosis partially implemented for eventual self-healing.

9-28-17
Updated scripts: train, library
A full RELEASE ALL is now performed at the script start to prevent any issues.
Numerous adjustments to how failed casts are tracked and handled to hopefully finally squash the last remaining traces of the issue that the previous update addressed.

9-27-17
Updated scripts: train, library, set
HarnessMax has been split into HarnessMax and ChargeMax, to allow setting cambrinth and harnessing with two different maximums.  Please set your ChargeMax variable!  It defaults to 20, a rather low number.
Consolidated casting logic to prevent several issues with spellcasting getting confused and to make it more predictable when it fires.
Adjusted spell cancelling code to prevent rare situations where the script stops casting entirely.
When spell preparation encounters a spell already being prepped, it will now release the spell and try casting again, rather than waiting for the next pass through the script.
Proper casting messaging set for Glythtide's Joy.
Removed tracking code for Attunement.  Issue is resolved.
Added text to weapon bonding to prevent a script halt.
Added code to dry an instrument when its wetness prevents playing.
Adjusted PerformCyclic variable to MAGIC display in set.cmd.
When doing CombatPerform, after locking performance a general spell release will be done before moving back to hunt to prevent issues with Sanctuary.

9-11-17
Updated scripts: train, library, set
Tracking information added to the script to try and diagnose the issue with MM Attunement.  This should only display for Klines.
Fixed a math error in the course of implementing tracking that could cause normal attunement to happen way more than it should over time.  This may be the issue Klines was seeing.  Leaving tracking in place to monitor.

Minor bugfixes to variable error correction.
Bugfixes to Eillie's Cry usage.
Sanctuary, Glythtide's Joy, and Blessings of the Fae added to Cyclics list.
Bugfixes to Cyclic use during Performance.
Cyclic switching logic was completely rewritten to accomodate proper use of 3 cyclics.  This only affects you if you use 2 or 3 cyclics at a time for training, but should be pretty transparent.
Added casting messaging for Calcified Hide.


9-9-17
Updated scripts: train, library, set, astral
Eillie's Cry added as a guild-specific option for Bards to make sure it's up before doing any performance training.
Charging a cambrinth item with more than your skill can support will now raise repeated alarms and halt the script in an alarm loop.
Updated Bundling Rope alarm to use the new alarm format.
Script now compensates when Genie is incorrect about a moon being up by fixing the $Time variables.  It's not perfect, as this will intermittently get reset by the Time plugin, but it's better than blindly recasting CoL over and over.
Sound for GM Alerts is now different.  Please grab MiniFanfare3.wav from the sounds folder.
Removed some comments that were no longer necessary from the script.
Fixed a bug with instrument cleaning that caused the cloth not to be stowed properly after cleaning.
A bug that caused Moon Mages to use regular perceive instead of their cheatyface perceive mana has been fixed.  Go back to your ivory tower of easy Attunement experience.

Mana is now released at the end of the astral travel script.

9-3-17
Updated scripts: set, library, astral
Minor update to help text on set.
New spell preparations added.

Many subs have been completely rewritten in astral travel script.  It is now much more fault-tolerant to type-ahead lines, roundtime, and other such issues.
Mana is now no longer released if moongate is being used to exit the ways.
Some danger alarms have been added to astral travel.
Astral travel now properly ends if you try to enter the ways from a warded room instead of going bonkers.

8-23-17
Updated scripts: train, library, set, astral
Fixed a bug where mana leakage was not properly prevented under a particular type of failure to cast a spell.  It will now automatically release mana if harnessing is enabled on any failed spell.
Script will now abort casting of a spell if during the preparation you don't have enough mana for your prep amount.
Changes to facing logic to cause a spell to be released if it is attempted to be cast at a creature and there are none in the room.
Script now stows items in hand at script start to prevent various issues.
Added a missing colon to set.
Added missing messaging for failed sorcery cast to casting logic.
Script will now force Preserve to YES if Harvest is set to YES.

Astral travel now allows "river" as an option to get to riverhaven.
Fixed a bug causing the script to pow twice at the center, where it shouldn't have to at all.

7-17-17
Updated scripts: train, library, set
Attunement now uses standard skill lock mechanics.  This should save time over long training periods.
New option: StraightCast.  If set to YES, this will add all mana to the prep if both Attunement and Arcana are locked.  Example: prep sw 100 instead of prep sw 5, harness 95.  Only for advanced attunement characters.  This saves time and nerve damage over the long run.
Added variables to set different cyclics for training when during performance than during regular training.  Primarily useful with the CombatPerform option.
Numerous bugfixes related to uncommon circumstances for Perform training.
Minor upgrades to facing logic.
Minor tweaks to spellcasting messaging to clean it up a bit.

7-5-17
Updated scripts: train, library, set
Alerts:
  Alerts now have their own section in set.cmd.
  Alert text that echoes to the game window is now highlighted yellow.
  Spell backfires and mana slippage alerts are now set under the NerveAlerts option.
  Added new item count alerts, including one where you've hit 500 items that cannot be turned off.
Other:
  Changed Manipulate to use standard skill lock mechanics to prevent it from wasting time.
  Added some new logic to prevent a script hang with a rare bundling issue.
  Fixed a bug that could cause the script not to know playing was stopped on an instrument.

6-29-17
Updated scripts: train, library, set
Added InstClean and InstCleanCloth for instrument cleaning.
If cyclic spells for training are enabled they will be used during Performance training.
Adjusted syntax of tied item use to prevent rare issues with sheathe.
Fixed a typo in performance logic that would rarely cause a hang.
Bugfixes to Bugout and CombatPerform movement functions.
Bugout and CombatPerform now will not attempt to invoke a bond before moving unless LTBond or HTBond is set to YES.
CombatPerform will now release any cyclics after moving one room but before moving to the end destination.

6-27-17
Updated scripts: train, library, set
Fix to GMAlerts so that GM logins will not trigger.
Fix to SpeechAlerts so that only player speech will trigger (as opposed to Shadowlings, etc).
Added an alert for backfires.
Tightened up emote triggers for wave emotes to avoid firing when certain spells are cast.
Fixed a script-halting bug that could occur if all targets in the room were dead at the time of firing an aimed weapon but the messaging for the target being gone had not had a chance to fire.
Tweaks to teaching attempt, even if stealth isn't locked yet.
Added a PerformCombat and a PerformCombatRoom option.  If set, these will have your character periodically leave combat to the specified room, train performance (and any other skills that are set that are trainable with performance) and then return to combat.  Next step is to have options for things like FOrtress of Ice or Sanctuary.
Note added to set.cmd that TeachSkill must equal the exact text of the skill, such as "twohanded edged".
Added a Sounds folder to the Google Drive.  Please make sure all of the files in there are in your Genie sounds folder or all alerts will all sound the same.

6-21-17
Updated scripts: train, library, set, p, astral
More refining of speech alarms.
Alarms now echo with Alarm: Type both for further troubleshooting of alarms and to make it more clear what the script is noticing.
Some sounds have changed for Familiar, Locate, Riftal Summons, and Empathic Touch, staying within Isharon's sound files.  I intend to add more later for better variety.
Bufgix for script halt if teaching to someone who is not visible or not present.
Added the standard 1-second pause to the Harness sub to prevent spamming in case of stuns.
Made aimed weapon handling more efficient.  Aimed weapons will no longer spam the ===Weapons Checking=== messaging while aiming.
Fixed a bug in TEXTSET function in set.cmd that occurred when setting some variables.
Added a workaround to TEXTSET due to the tolower function causing any input containing a number to return a blank line and leaving "2he" unable to be input.
Added the post-casting commands necessary for IOTS and Shadowling to p.cmd.
Astral travel script has been heavily reworked.  It is now more accurate and properly executes the extra safety routines.

6-20-17
Updated scripts: train, set
Bufgix for thought triggers firing for any gweth message if you have verbose thought messages on.
Bugfix for PvPStealthAlerts name.

6-20-17
Updated scripts: train, library, set, p
Bufgix for Whistle Piercing script halt when failing to use.
Bugfix for script halt when casting Will of Winter.
Focus Moonbeam, when cast with p.cmd, will now default to 64 mana (the maximum effective cast) if left unspecified and will cast to the moon that is up with the longest time left, if left unspecified.
Tightened up some speech and thought triggers to prevent accidental firing (specifically during predictions) and to be more exact with what they catch.  Expanded their scope to other types of speech.
Added a large number of additional emotes someone can do in the room that will trigger emotealerts.
Added a PVPStealthAlerts option.  This is intended to alert you with the same sound as PvPAlerts if anyone is doing any kind of stealth in your room.  Moved some of the PvP alerts into this category and added others.  Be warned, this will be making sounds all over the place if you have a hunting partner.
NecroSafety now has a function.  If set to YES, buff spells from the Transcendental Necromancy book will not be cast if within a justice area.  More to come for this.

6-17-17
Updated scripts: train, library, set
Fixed a bug caused by consolidating variables into library.cmd that meant that anyone not using Rising Mists would never have hiding trigger - which is why I never noticed it, since I use RM.

6-16-17
Updated scripts: train, library, set
Added SpellTracking option.  This will periodically display the count of how many times you've cast each training spell for analysis purposes.
Several bugfixes to Domain use.  Moved Domain use to the top of the order so it would execute at script start due to sitting issues.
Domain use will now only happen once, at the beginning of the script, pending code to track actual elemental charge states.


6-15-17
Updated scripts: train, library, set p
Notes: Determined that the message "You don't think you can manage to ignite another weapon at the moment." is caused by not waiting the couple of seconds after release for ignite to dissipate off of a previously cast weapon.  If the weapon ignite is to be cast on is the same that already had ignite on it, then there is no need to wait for this message.  I tested having ignite attempt to match the casting target of the current cast to the last object ignite was cast on.  If it did not match, it would wait until it sees the full release message before continuing to casting.  This wastes about 3 seconds each time it happens, and with EvenTrain on it happens fairly often.  For this reason, I set Ignite to automatically release immediately after casting.  I kept my test code, so we can talk about this.

Ignite will now automatically release the spell immediately after casting if used for training.
Modified Ignite handling in p.cmd to cast on either the object in the right hand or the object specified in the command line for more effective use.
Ignite is now removed from the Obuff list pending further work.  Use p.cmd to cast it quickly before a battle in an automated fashion.
Domain variable's name has changed and there is now an DomainType variable to choose the domain used.



6-14-17
Updated scripts: train, library, set
Added all basic prep messaging for all guilds.
Completely rewrote Ignite handling in the CAST function.  This code is a little verbose and echoes a number of things to the main window.  As I become more confident in this working properly, I will remove.
Added IgniteBackup variable in the Guild section.  This needs to be set to the preferred weapon to grab if there is no appropriate weapon to cast on in-hand.  Handled it this way in case the user has no melee weapons set to train.

6-13-17
Updated scripts: train, library, set
General Updates
Removed redundant text at script start for symbiosis checking.
Added option for pole and stave weapons to be tied to the item set as your container variable.
Added correct messaging for drawing a weapon that's attached to a tie.
Fixed STOWITEM function to stow the left hand item if it is attempting to stow something from the ground but can't because the hands are full.

Bard Updates
Added Blessings of the Fae, Eillie's Cry, Misdirection to buff spells.
Added Aether Wolves, Albreda's Balm, Damaris' Lullaby, Desert's Maelstrom, Pyre as cyclic debilitation/tm spells.
Added Blessings of the Fae, Caress of the sun, Eye of Kertigen, Faenella's Grace, Glythtide's Joy, Hodierna's Lilt, Sanctuary as cyclic spells.
If Misdirection is active in the bufflist, stealth will not be attempted unless it is up, in line with other stealth buffs.
Added special snowflake prep messaging for each Bard cyclic.  Ugh.
Added WhistlePierce option for Bards to train Bardic Lore.

Other Guild Updates
Necromancer and other guild-specific options are moved to the Guild section of set.cmd.
Fixed a script-halting bug if a creature is dissected twice.
Fixed some bugs with Necromancer storage of harvested material.  Despite this, it is still having issues I'm working on.  Use at your own risk.
Added PGPrepMana and PGAddMana variables.  These will default to 5 and 0, respectively.  This should be set for any Moon Mage with Astrology turned on.  This will allow PG to be cast at greater than minimum mana, significantly reducing observation roundtime under cloudy conditions.  Formerly, PG was only cast at minimum prep because I didn't know this was a thing.  I recommend putting this as close to cap as you can.


6-9-17
Updated scripts: train, library, set
Moved the more obnoxious script-related alerts to ScriptAlerts variable.  This is set to NO by default.
Fixed bug in display of GMAlerts variable in set.cmd.

6-8-17
Updated scripts: train, library, set, p
Reorganized and added more options to various safety alarms.
Added sniping and someone revealing themselves to the PvP alarms.
Added alarms for Locate and Familiars watching the area.  No variable is associated with these.
Added a EmoteAlerts option.  This produces several alarms based on emotes someone might do in the room, similar to SpeechAlerts.  Default is on.
Added a GMAlerts option.  This controls alarms based on various ways GM's might talk to you or script check you.  Default is on.  These now make a different sound than standard speech alerts.  Turn off at your own peril.
Added the entire Necromancer suite of augmentation, utility, and warding spells to p.cmd.
Added a HarvestStore option to store harvested material instead of dropping it.

6-7-17
Updated scripts: train, library
Dissect will no longer halt the script if performed on an invalid target.
Creature matching refined to properly identify Endrus serpents.


6-4-17
Updated scripts: train, library, set
Moved Necromancer variables to their own section in Set.cmd.
Added Butcher's Eye, Calcified Hide, Researcher's Insight to buffs.
Added Ivory Mask, Researcher's Insight to obuffs.
Added Worm's Mist to mbuffs.
Fixed a script-halting bug when attempting to harvest on a construct.
NecroSafety variable is active, but doesn't do anything yet.  More here in the future!
Fixed a bug that could cause an endless loop if the sheathe command could not find the appropriate container.  Weapon will be stowed instead.
Predict function will now properly get out the prediction tool if it tries to predict and the tool is not in-hand.

5-31-17
Updated scripts: train, library, set
Harvest ritual should no longer incorrectly prioritize Skinning over Thanatology Experience.
Harvest ritual will now allow skinning if a harvest is attempted but is not possible on the creature.
Harvest ritual will not fire and instead skinning will be attempted if Thanatology is locked.
Bugfixes for necromantic rituals.
Bugfix for rare issue Ethereal Pathways.


5-22-17
Updated scripts: train, library, set
Added better tracking and processing of symbioses.  Script no longer just spams release symbiosis at every cast where one is not needed.
Fixed a bug related to tracking of Steps of Vuan being active.
Added Universal Solvent, Rite of Contrition and Rite of Grace as valid cyclic spells.
More spell preps added to prepare function stop script halts.
Added support for dissect necromantic ritual.  Dissect can be done alongside preservation, but not with harvest and not with skinning.
Cleaned up some skinning code to prevent attempting to skin a critter that will not be skinnable due to necromantic ritual.
Added support for Philosopher's Preservation as a buff.

5-20-17
Updated scripts: set, library
Added SPECIAL option for HTBond and LTBond for compatibility with auction weapon.


5-20-17
Updated scripts: train, library
Added functions to remove invisibility.
Ritual focus invoking will now remove invisibility if necessary in order to complete the cast.
Added support for invisibility to unhide function.
Training in combat with Steps of Vuan up should no longer cause script hangs.
Added .TRAIN MUSIC option to allow for easy music lore training along with all compatible skills that are enabled.
Added .TRAIN MUSICONLY option to only train performing.  Useful for running alongside climbing scripts.
Tied instrument assessing to the Appraise variable.  Instruments will no longer be assessed during performance training if appraisal is turned off.
Added support for non-chaos symbioses in the release symbiosis sub.
Added a 3 second pause when attempting to face next and not finding another critter to face to minimize spamming.


5-20-17
Updated scripts: train
Fixed a bug I accidentally introduced to the observe heavens function.

5-19-17
Updated scripts: train, library, set
Fixed a script halting bug when observing the heavens indoors but through a window.
Added InstrumentWorn variable to support worn zills in noncombat training.  Note that worn zills cannot be assessed, so training them in this method will result in the loss of the appraisal experience from assessing the instrument.
If InstrumentWorn is set to NO, but the instrument is currently being worn, the script will now properly remove the instrument to play it and assess it instead of hanging.
Added messaging from zills removal to REMOVE sub to fix script halting bug when removing them.

5-19-17
Updated scripts: library
Updated instrument matching code to accomodate inexact instrument names in the variable.

5-19-17
Updated scripts: train, library, set, p
Fixed a script-stopping bug if it got all the way to aiming but there was no creature in the room.
Fixed an issue with assess instrument that would cause a script halt with zills.
Fixed a bug that caused issues with p.cmd halting.
Commented out nonfunctional max variables from set.cmd until further notice.

4-1-17
Updated scripts: library, set
Bugfixes for Destiny Cipher.


3-30-17
Updated scripts: train, library, set
Textbooks now have a completion timer for every individual list item.  This should make textbook use more efficient.
Added Will of Winter as a ritual spell and as an obuff.
Added Drums of the Snake as a buff and obuff.
Added support for Mind Shout and Heavy TM timers.  Mind Shout has its own variable set.  It will use this when casting debilitation unless the heavy TM timer is active, in which case it will use your standard debilitation spell.
Added support for Destiny Cipher as a buff.

3-18-17
Updated scripts: train, library, set
If MaxSwings is set to 0 then it will allow infinite weapon swings.
Added PredictionTool and PredictionToolItem variables.
Added mirror and bone use for predictions.
Rewrote Align and Predict code to use proper gosubs.  This will preserve proper execution order in the script.
Fixed windboard code to properly take webbing into account.
Explog now outputs the date in the filename, which will sort experience logs into different files by day.

3-15-17
Updated scripts: train, library, set
Added alert for an empaths touching you.
Added textbook functionality via Textbook, TextbookList and TextbookTimer variables.
Added "do not use if locked" functionaliy as with other skills to textbooks.  Compendiums remain as they are, because they probably don't need it.
Fixed minimum timers for several skills.
Added experience logging via Explogging and ExpLoggingTimer variables.
Removed explog.cmd script from library due to functionality being automated.
Added Astrology timer functionality via the AstroTimer variable.
Added variable fixing to Piercing Gaze at script start if Astrology is used to prevent problems.
Fixed a bug with BlufmorGaraen variable fixing.
Cleaned up some old Astrology logic.
Added AstroThrottle variable, but functionality is not present yet.


3-10-17
Updated scripts: train, library, set, p, explog
Polecombo is now functional.  Setting it to slice or puncture will change what types of attacks pole weapons use.
Bugout is now forced to off regardless of setting options for all preset train.cmd options except for "combat", "kill", and "skin".
Added CompendiumTimer, Textbook, TextbookTimer, TextbookItem, Appraisetimer, OutdoorTimer, Hunttimer to set.cmd.
Updated logic for appraise, collect, study, hunt to use new timer variables.  Updated functions to use consistent logic.  No new entries are necessary.  Script will set fields to default values on its own.
Updates to gateto logic on p so that it will better test if the moonbeam actually shifts properly.  All text is likely not captured yet.
New script - explog.cmd.  Every time the script is run it will dump exp in a CSV format to Explog-Charname.txt in the logs folder.

2-20-17
Updated scripts: train, library, set
Fixed a typo for speech alerts.
Added SpeechAlert variable into the game.  It will now allow you to toggle alerts for conversation.
Various other small bugfixes.

2-14-17
Updated scripts: library, set
Fixed a script-halting error with sheathe.  If there is no preset sheathe item set, script will stow it instead.
Fixed a missing bracket that broke set.cmd

2-09-17
Updated scripts: train, library, set, p
Added General category to set.cmd and moved several options there.
Added StanceChange option.  If set to NO, it will use the custom set only except for when an aimed weapon is in hand, in which case it will use shield.  Default sets it to YES, which operates stances as normal.
Added HealthAlarm option.  This allows setting, 1-99, the point where the health alarms will sound.
Added Bugout, BugoutNum, and BugoutRoom variables.
Added Bugout functionality.  This will trigger when health drops below BugoutNum.  This an also be triggered via .TRAIN BUGOUT.  Bugout checks for standing status, attempts to invoke a bond, will move in a random direction away from the room (to counteract potential automapper issues) and then will go to the designated room.
Added PoleCombo variable to support slashing vs piercing polearms in the future.  Currently, polearms assume thrusting maneuvers are best.
Tweaked stance changing logic to make changes more reliable and timely.
Fixed script-stopping bug where observing the sun after the sun set could halt execution.
Minor bugfixes to p.cmd.

2-5-17
Updated scripts: train, library, p
Adjusted train.cmd script launch to display main help if input isn't a recognized option instead of launching noncombat training.
Added Perseverence of Peri'el to ritual spells.
Fixed a bug with Moongate not properly allocating mana in p.cmd.
Abbreviations now allowed on spell names in p.cmd.
Locate and Riftal Summons will now automatically perform the pre-work necessary.
Teleport and Moongate now require a moon or they won't cast, in order to avoid rogue gates.  Oops.

2-4-17
Updated scripts: train, set, library, p
Added GoL and BS to possible obuff list.
Addition of some new critters to lists.
Cleanup of critter categorization.
Fix to prevent the script from spazzing if the critter dies during brawling analyzing.
Prepping routines adjusted so that a prepmana of 0 will output only the spell name to the game, in order to prep at minimum.  "prep ags" instead of "prep ags 0".
Moved CASTINGLOGIC and ARRANGEMANA to library.cmd to facilitate casting script.
Moved ritual spell definition to library.cmd
Added a few more strings to CAST sub to properly trap for edge cases.
Braun's Conjecture, Destiny Cipher, Read the Ripples added to list of valid ritual spells.  Still not added to any buff lists without further testing.
P.cmd script is active for prepping AP, Empath, MM, WM spells.


11-9-16
Updated scripts: train, library, set
Regenerate spell added.
Bug fixes to nonviolent tactics.
"Empath" option removed from command line.  This is handled with one variable now.
Bugfixes to Absolution.
Bugfixes to gem pouch counting.
Minor bugfix to .train cyclic option.

10-27-16
Updated scripts: train, library
Consolidated speech alarms using regex.
Added eval triggers for alarms for health and death.
Added alarm using stun sound for Tezirah vision.
Added alarms for several more stun-related messages.

10-26-16
Updated scripts: train, library, set
Mbuffs are now prioritized above standard buffs.
Psychic Shield is added as an mbuff.
Removed info gathering functions for circle and switched to new variable.  ExpTracker provides its own variable for it.
Removed variable for targetselect.  Functionality was only necessary for empaths and caused problems elsewhere.  It has been folded into avoidshock.
Lots more work on Blufmor Garaen logic to compensate for this change.
Removed some echoes for spell switching.
Added sound alerts for Empathic Shock.
Empath combat is now fully implemented.  Empaths should have AvoidShock set to YES if they are sensitive.  

10-16-16
Updated scripts: train, library, set
Included more output for spell choices to provide transparency and a couple more error checks.
Added new variable, targetselect, to decide if the script will choose what target to face or if it will just face next.  Don't use it yet, it's still in testing.
NUmerous improvements and streamlining to any part of the script that involves target selection.

10/14/16
Updated scripts: train, library, set
First time perc and spell variable reset will not be run if killingonly = "YES" in order to facilitate use during invasions.
Cyclic spells will not be recast on script start if killingonly = "YES" and the desired cyclic spell is up.
Fixed a bug that would cause custom variable sets not to register the proper cyclic TM variable in time for the above mentioned killingonly check.

Old spell logic is removed.  New Spell logic replaces it.  NewSpellSwitch variable removed.
New spell switching now looks for monsters to be present in order for TM and Debil to be considered for casting.
Script will now stop trying to harness when it fails to do so when casting spells, in order to avoid nerve damage.  Output echoes are changed accordingly.
Added 4th possible training spell, and sorcery as a possible skill.

Weapon usage, TM and Debil under new spell switching will now check to see if any monsters in the area are valid targets, and will not fire if they are not (unless KillingOnly is on).
When trying to face a specific target, script will now retreat if necessary to be able to face that target.
AvoidShock variable added.

10/05/16
Updated scripts: train, library
Bugfixes for spell switching.

10/2/16
Updated scripts: train, library, set
The main spell switching has been completely rewritten.  It now looks at the spellcasting skill with the lowest mindstate and casts on that.  To turn on this new method, set newspellswitch to YES.  If you still want it to lock TM and Debil first, set tmdbprior to YES.
Script now sheathes non-worn weapons when putting them instead of stowing them which automatically returns them to the weapon they were extracted from.
Bugfixes for windboard use.

9/28/16
Updated scripts: train, library, set
Added a couple of strings of text to face command to prevent script stalls.
Added filter to remove "that appears immobilized" messaging when using manipulate or recall.
Many minor enhancements to smooth over usage in Duskruin
Added variables for BG, DB.
Enhancements to MAB, BG use.
Refined reload logic for MAB.
Fix to stow musical instrument after playing when in certain case it wasn't stowing.
Fixed a bug that could cause the script to stop hiding and never start again if it failed hiding too many times.
Added variables for Windboard use.
Added windboard logic.
Plugged Nonviolent Stealth into standard Stealth logic.
Removed support for the tmdbprior variable.  Variable will be repurposed during spell mechanics rewrite.

9/12/16
Updated scripts: train, library
A few more minor refinements to aimed weapon ammo handling.
Refined logic for Manipulate facing.
Fixed a bug causing Manipulate to fire too often.
Fixed a bug that would cause a script stop when unloading a bow. 

9/11/16
Updated scripts: train, library, set
Several minor code changes in bow weapon handling.
Manipulate is now live and will manipulate appropriate critters when turned on and an Empath.
Absolution added as a ritual spell.
Several bugfixes and reworkings of bow and ammo handling.
Fixed a bug preventing attunement from firing.

9/8/16
Updated scripts: train, library
Nonviolent stealth now properly checks for armor if Armorswap is enabled.
Nonviolent stealth is no longer on a timer and immediately unhides.
Some bugfixes to climb practice.
SCript will now detect when the climb is too difficult and stop attempting to practice climbing.
Script will now detect when the climb object is not present and will stop attempting to practice climbing.
Moved Astrology to come before all spellcasting.
Added a check to reset Clear Vision variable if astrology is being used.
Various additional checks added to bow ammunition manipulation.

9/7/16
Updated scripts: train, library, set
Perc Health now requires a monster to be in the room before it will fire if being used in combat.  Noncombat perc health is unchanged.
Nonviolent Tactics now requires a monster to be in the room before it will fire.
Moved Astrology to be directly below buffing, instead of below all spellcasting to prevent it from never predicting.
Fixed a bug with displaying abuffs and no default set for abuffnum that would cause a script crash.
Stealth will now be trained by just hiding even if weapon training is turned off.

9/6/16
Updated scripts: train, library, set
TM/debil are no longer prevented from occurring if tactics is being trained.
Fixed a bug where the script would stall if mistakely unloading an unloaded bow.
Fixed a bug where the script would stall if attemptig to bundle without a skin in hand.
Added a TRAIN CLIMB <object> option, which will perform climb practice on the object in addition to any appropriately set noncombat training options.  This fits within the perform ecosystem.
Added the paralysis, paralysisprepmana, paralysisaddmana variables for Empaths.
Added a TRAIN EMPATH option, which sets the appropriate variables for nonviolent Empath training.

8/31/16
Updated scripts: train, set, library
Added Perceive Health as an option for Empaths.
Added nonviolent Tactics option.  This can be used in conjunction with regular tactics or in lieu of.  It currently circles unless fatigue is < 80, in which case it will bob.
Script now traps for kneeling and will stand up.
Confirmed STATUSCHECK, which is called after every action, will now cast all spells if ready.
Fixed an error with ritual foci messaging that could cause a script stall if casting indoors.
Reoriented guild-based skills (astrology, summoning, praying, empathy) to happen after the buffing portion of the script but before weapons, so that buffing would happen first before those large roundtimes are entered into.
Audited script for proper usage of STATUSCHECK.  Added a few instances.  This should make the script a bit more responsive to the bad things that statuscheck prevents.
Added STATUSCHECKs at various locations within weapon routines and between analyzes.  This should make the script more responsive to fully prepped spells and also being knocked over, stunned, etc during combat routines.

8/29/16
Updated scripts: train
Fixed a bug with MPP not detecting properly.

8/29/16
Updated scripts: train
Fixed a stupid bug with compendiums I created by accidentally deleting an echo.

8/29/16
Updated scripts: train, library
Fixed a bug with the trigger for falling into warklins.
Added proper casting mechanics to HYH and OM.

8/29/16
Updated scripts: train, library, set
Added auspice to mbuff list.
Added Hydra Hex to cyclic debilitation list.
Added Glythtide's Gift to obuff list.
Added basic OM maintenance with OsrelMeraud, OMPrepMana, OMAddMana, and OMTimer variables.
Cleaned up Research variable display.

8/29/16
Updated scripts: train
Added a the stunned sound for when you fall through dolomars into warklins.

8/28/16
Updated scripts: train, library, set
Teaching variables redesigned and basic teaching is live.  Defaults are set.  Onus will be on the listener to decide if this changes through communication.  Relevant variables: teaching, teachingskill, teachtargetnum, teachtarget1, teachtarget2, teachtarget3.  Script will attempt to teach teachingskill to all targets present in the room at script start, will monitor teaching status, and will reteach so long as you are not actively training stealth (because there's no point - you'll just lose it again).
Script will respond to people that are set in the teachtarget variables if they "ooc teachme <skill>" by switching to teaching that skill
Added a TEACH command option to Train that will do nothing but teach.

Tranquility is added as a valid mbuff.
Aggressive Stance and Vigor added as a valid buff or obuff.
Mental Focus added as a valid buff or mbuff.
Gift of Life, Iron Constitution, Refresh, Persistence of Peri'el, and Blood Staunch added as valid buffs.
Removed some no longer necessary comments for item storage.
Fixed a bug with recall and flying creatures with the poststring "that is flying around".

8/21/16
Updated scripts: train, set
Fixed a bug that prevented proper reset of obuff and mbuff variables.
Cleaned up some misc code in Set.
Rewrote all buff display code in Set.
Removed "addmana" variable from display for ritual spells.
Minor bugfixes to some help text in Set.
Wrote a new function to set 1-3 variables.
Added display and variable setting code for new variables - teaching, teachskillnum, teachskill1, teachskill2, teachskill3, teachtargetnum, teachtarget1, teachtarget2, teachtarget3, maxtm, maxdb, maxstealth, maxtactics, researchnum, researchtype1, researchtype2, researchtype3.  None of these function live yet or have defaults set.

8/16/16
Updated scripts: train, library, set
Added a standard perc every 5 minutes for MM's, independent of Attunement locking in order to keep spell variables on track.  This requires Attune to be set to YES to function.
All buff options now force Harnessing to YES so that the mana specified can be effectively used.
Rewrote Arrangemana function to resolve a longstanding bug that prevented proper allocation of mana in excess of cambrinth.
Ritual spells now will not ever require any mana to be set in the addmana field to work properly.

8/13/16
Updated scripts: train
Added AUS post-cast recognition.

8/13/16
Updated scripts: train, library
Removed "not appraising" messaging.
Set a perc to happen after casting COL to make sure it doesn't recast.
Changed Shadowling post-cast recognition to match COL and IOTS.

8/12/16
Updated scripts: train
Revamped MM Firstperc code to fix bug with resetting spell variables multiple times in a script.

8/12/16
Updated scripts: train, library
Script now automatically resets variables of any buffs that are enabled before execution, and then immediately percs to get accurate information, so long as perceiving is enabled.
Added messaging for which sets of variables get reset at script start for confirmation.
Variable reset now happens with .train buff and its variants.
Added a switch to check if non-TM/debil casting is enabled, and if it's high enough, before unlocking those skills, to make sure Aug/Util/Warding doesn't get shortchanged over time.
Minor bugfixes to cambrinth item handling.  Please call it "cambrinth orb" in cambitem if that is necessary to differentiate.
Added error handling for full hands to GETITEM sub.

8/3/16
Updated scripts: train
Changed sound on item alert to be less obtrusive.
Changed sound on thump to be the same sound as when getting stunned.
Fixed a bug with IOTS when it backfired.
Fixed an unrelated bug where the script stalled when AEG backfired.

8/1/16
Updated Scripts: train, library, set
Added an alert for generally asked questions in the room.  Non-questions already had this.
Added an alert if you are thumped.
Script now uses PERC after casting IOTS to properly determine if it was cast.
Renamed the Ambush variable to the more appropriate Stealth.
Removed obsolete code from an older way of implementing Ambush.

7/27/16
Updated Scripts: train, library
Removed moonbeam-related code for Mind Shout.
Rewrote several aspects of variable handling for weapons.
Added an alarm and script ending for when buffing is completed.

7/20/16
Updated Scripts: train
Added logic to unlock tm and debil when all normal spellcasting is locked.
Added logic to unlock tm and debil when all weapons are locked.
Removed more extraneous text from EvenTrain.

7/12/16
Updated Scripts: train, library, set
Some further bugfixes to EvenTrain when all weapons are locked.
Removed redundant messaging from EvenTrain.
Added support for php and ks as buffs.
Fixed a bug with waist-worn bundles.

6/27/16
Updated Scripts: train, library
Completely rewrote EvenTrain algorithm.  New and improved!
Fixed a bug with stowing gems on a freshly tied pouch.

6/27/16
Updated Scripts: library, train
Fixed a script-halting error with necromantic harvest.
Fixed several other bugs with necromantic rituals.
Enabled stealth dependency on obfuscation, just like shadows and rising mists.
Added a check for the harvest ritual to only perform it if skinning learningrate is > 20.
Fixed an issue that could cause performance and braiding not start up again after locking, even if the skill dropped too low.
Fixed a bug that caused a stall when dropping cards for a tkt item.

6/17/16
Updated Scripts: library, train
Bug fixes to  STOW sub matching.
Adjusted handling of Eyes of the Blind.
Bugfixes to casting of pv and acs, and cleanup on the CAST sub.
Fixed a bug that could cause a spell not to target properly if it attempted to target and there was already a spell prepped.
Fixed a bug that could cause a gem to remain in the hand after tying off a pouch.

5/25/16
Updated Scripts: library, train, set
Added several Nexus, Harmony, Rage of the Clans, Drums of the Snake, Echoes of Aether, Naming of Tears.
Fixed some potential issues with area buffing and removed old, unused code.
Fixed some minor issues with Magnetic Ballista handling.
Some small bugfixes to bundle rope handling.

4/26/16
Updated Scripts: train, set
Added support for the Paladin spell Righteous Wrath

4/26/16
Updated Scripts: library, train
Fixed a problem with melee and thrown weapons incrementing count outside of attacks.

4/26/16
Updated Scripts: library, train
Added case-normalizing for checks with weapontypes to avoid certain bugs.

4/26/16
Updated Scripts: library, train
Added visible tracking for number of hits.
Fix a bug with unloading a ranged weapon and wielding another.


4/24/16
Updated Scripts: library, set, train
Moved several combat-related functions from library to train.
Condensed and rewrote weapon switching code.
Added variable for max number of swings on a weapon before moving on.  Max is 60, default is 40.  This does not apply to eventrain.
Added variable for poleworn and staveworn, defaults to NO.
Script makes noise when out of bundling rope.


4/23/16
Updated Scripts: train, library
Fixed a bug with backstabbing when not facing something.
Adjusted backstabbing so that it will ambush if attacking a critter that's not backstabbable.
Added support for tying up gem pouches.
Added support for properly pulling arrows out of living critters.
Fixed a bug with stances that could cause repeatedly setting the same stance.

4/22/16
Updated Scripts: train, library
Fixed a bug that could cause stance to switch to parry, even when shieldonly is enabled.
Added some comments to help track down any problems with backstab.

4/21/16
Updated Scripts: library, train
Script now makes noise when stunned.
Script makes noise when out of gem pouches.
Bugfix to stance logic to ensure shield usage with aimed weapons even when parryonly is set.
Fixed a bug that prevented backstab use.
Added support for offhand backstab.

4/20/16
Updated Scripts: library
Minor bugfixes to gem handling.
If gwethstones are not set to be saved they will now be treated like any other gems.
Added support for swapping out full gem pouches.  This is a new feature and may be buggy.

4/20/16
Updated Scripts: library, train
Fixed bug with picking up gweth stones.
Removed comments from Astrology portion to lessen scroll.
Rewrote some of the core stow mechanic to fix potential inaccuracies.
Fixed bug with bundle handling if you didn't already have a bundle.

4/18/16
Updated Scripts: library
Fixed a bug that could cause attempted backstabs by non-thieves.

4/18/16
Updated Scripts: library, train, set
More bugfixes for pathways.
Gwethstones are now saved if the variable is set, even if gems are not set to be saved.
Added better checking for stealth when firing.
Added Snipe for Rangers and Thieves if stealth is turned on and appropriate weapon is used.
Added Backstab variable and support in script for Thieves.
Added alarms for death and if health goes below 70%.


4/17/16
Updated Scripts: train, library, set
Fixed a bug with tracking more than 1 cyclic spell.
Rewrote noncombat switching.
Bugfixes for swappable weapons.
Added broadaxe to list of swappable weapons.
Fixed variable name being misrepresented for attunement.
Bugfix for initial variable setting for braidtarget.
Bugfix for obscure problem with outdoorsmanship.

4/16/16
Updated Scripts: train, library
Bugfixes for pathway spamming fix.
Fixed text for new pathway failure message.

4/9/16
Updated Scripts: train, library
Added sound effects and window flash for various hostile actions while script is running.
Fixed a bug related to improper stowing of cambrinth.
Modified summoning to only attempt once every 30 seconds to avoid spamming.

4/8/16
Updated Scripts: library, set, train
Added variable for cleric prayer to custom.cmd.  This may need to be updated manually.
More minor bugfixes and code optimization.

4/6/16
Updated Scripts: library, set, train
Several item-handing bugfixes.

4/4/16
Updated Scripts: library, set, train
Added a savegwethstones variable.  This variable is by default set to NO.  If it is off, they will be treated like gems.  If it is on, they will be put in the item referenced by STORAGE.

4/3/16
Updated Scripts: library, set, train
Bug fix to compendium stowing and possible misrouting.
Rewrote ammo handling to prevent spam and improve reliability.
Will no longer retrieve ammo for weapons not being used.
Script will make noise every 5 seconds or so, flash the genie window, halt execution, display a message when you are out of ammo.
Fixed rare bug where checking for bleeding wounds while stunned would cause tending of the wrong location.
Added Storage variable and support for saving gweth stones and storing them rather than putting them in gem pouches.
Added Pray option for Clerics to gain devotion in combat.

4/1/16
Updated Scripts: library, set, train
Added option for non-worn cambrinth.
Numerous bug fixes.

3/30/16
Updated Scripts: library, train
Fixed a bug with stonebows which caused them to sometimes not clear the full aim variable.
Cleaned up bow use logic, added more checks for odd situations.

3/30/16
Updated Scripts: library, set, train
Put in a workaround to help prevent Shadowling from being recast.
Added bowworn and xbowworn variables to determine where to stow the weapons to.

3/29/16
Updated Scripts: library, train
Put a 1 second pause after an advance to prevent spamming.
Fixed a bug with the dropskins variable.
Moved echo from weapon training to avoid spamming when all weapons are locked.

3/28/16
Updated Scripts: train, set, library
Improved support for bastard sword adjectives - "war sword" and "bastard sword".
Repaired error checking bug to allow weaponmin variable to be changed.
Fixed bug that could prevent hiding if shadows or rising mists were not actually scheduled to be cast in the script.
Fixed bug with error checking on lthurl and hthurl variables.
Added option to drop skins instead of bundling them.
